<div class="row"  (click)="closeContextMenu()">
    <div class="col-md-12">
        <div class="menu-tool-bar he" style="line-height: 16px;">
            <div class="gr-tool-bar2">
                <!--Phiếu chi add by Hautv-->
                <a *ngIf="fromMCPayment" (click)="previousEditMCPayment()" class="aprev" [class.disable]="!isReadOnly || rowNumberMCPayment===countMCPayment || countMCPayment == 1 || isLoading">
                    <i class="mdi mdi-arrow-left" ></i>
                </a>
                <a *ngIf="fromMCPayment" (click)="nextEditMCPayment()" class="anext" [class.disable]="!isReadOnly || rowNumberMCPayment===1 || countMCPayment == 1 || isLoading"><i
                    class="mdi mdi-arrow-right"  ></i></a>
                <!--Phiếu chi-->
                <!--Thẻ tín dụng-->
                <a *ngIf="fromMBCreditCard" (click)="previousEditMBCreditCard()" class="aprev" [class.disable]="!isReadOnly || rowNumberMBCreditCard===countMBCreditCard || countMBCreditCard == 1 || isLoading">
                    <i class="mdi mdi-arrow-left" ></i>
                </a>
                <a *ngIf="fromMBCreditCard" (click)="nextEditMBCreditCard()" class="anext" [class.disable]="!isReadOnly || rowNumberMBCreditCard===1 || countMBCreditCard == 1 || isLoading"><i
                    class="mdi mdi-arrow-right"  ></i></a>
                <!--Thẻ tín dụng-->
                <!--Bao No add by anmt-->
                <a *ngIf="fromMBTellerPaper" (click)="previousEditMBTellerPaper()" class="aprev" [class.disable]="!isReadOnly || rowNumberMBTellerPaper === countMBTellerPaper || countMBTellerPaper == 1 || isLoading">
                    <i class="mdi mdi-arrow-left" ></i>
                </a>
                <a *ngIf="fromMBTellerPaper" (click)="nextEditMBTellerPaper()" class="anext " [class.disable]="!isReadOnly || rowNumberMBTellerPaper === 1 || countMBTellerPaper == 1 || isLoading"><i
                    class="mdi mdi-arrow-right"  ></i></a>
                <!--Bao No-->
                <a *ngIf="!isFromRSInwardOutward && !fromMCPayment && !fromMBTellerPaper && !fromMBCreditCard" [class.disable]="rowNum === totalItems || !isReadOnly
                || componentType === PPINVOICE_COMPONENT_TYPE.REF_QUA_KHO || componentType === PPINVOICE_COMPONENT_TYPE.REF_KHONG_QUA_KHO || isLoading" class="aprev" (click)="move(1)"><i
                    class="mdi mdi-arrow-left"></i></a>
                <a *ngIf="!isFromRSInwardOutward && !fromMCPayment && !fromMBTellerPaper && !fromMBCreditCard" [class.disable]="rowNum === 1 || !isReadOnly
                || componentType === PPINVOICE_COMPONENT_TYPE.REF_QUA_KHO || componentType === PPINVOICE_COMPONENT_TYPE.REF_KHONG_QUA_KHO || isLoading" class="anext" (click)="move(-1)"><i
                    class="mdi mdi-arrow-right"></i></a>

                <a *ngIf="isFromRSInwardOutward && !fromMCPayment && !fromMBTellerPaper && !fromMBCreditCard" [class.disable]="rsRowNum >= rsTotalItems || !isReadOnly
                || componentType === PPINVOICE_COMPONENT_TYPE.REF_QUA_KHO || componentType === PPINVOICE_COMPONENT_TYPE.REF_KHONG_QUA_KHO || isLoading" class="aprev" (click)="move(1)"><i
                    class="mdi mdi-arrow-left"></i></a>
                <a *ngIf="isFromRSInwardOutward && !fromMCPayment && !fromMBTellerPaper && !fromMBCreditCard" [class.disable]="rsRowNum <= 1 || !isReadOnly
                || componentType === PPINVOICE_COMPONENT_TYPE.REF_QUA_KHO || componentType === PPINVOICE_COMPONENT_TYPE.REF_KHONG_QUA_KHO || isLoading" class="anext" (click)="move(-1)"><i
                    class="mdi mdi-arrow-right"></i></a>
                <button *ebHasAnyAuthority="['ROLE_ADMIN',isKho ? ROLE.MuaHangQuaKho_Them : ROLE.MuaHangKhongQuaKho_Them]" class="button-navigation" [disabled]="!isReadOnly || isLoading" (click)="addNewPPI()"
                        title="{{'ebwebApp.outWard.tooltipAdd' | translate}}">
                    <i class="mdi mdi-plus"></i> <span jhiTranslate="entity.action.add">Thêm</span></button>
                <button *ebHasAnyAuthority="['ROLE_ADMIN',isKho ? ROLE.MuaHangQuaKho_Sua : ROLE.MuaHangKhongQuaKho_Sua]" class="button-navigation" (click)="edit()"
                        [disabled]="pPInvoice.recorded || !isReadOnly || isLoading || checkCloseBook(account, pPInvoice.postedDate)"
                        title="{{'ebwebApp.outWard.tooltipEdit' | translate}}">
                    <i class="mdi mdi-file-document-edit"></i>
                    <span jhiTranslate="entity.action.edit">Sửa</span></button>
                <button *ebHasAnyAuthority="['ROLE_ADMIN', isKho? ROLE.MuaHangQuaKho_Sua : ROLE.MuaHangKhongQuaKho_Sua, isKho? ROLE.MuaHangQuaKho_Them : ROLE.MuaHangKhongQuaKho_Them]" class="button-navigation" (click)="checkBeforeSave(false)"
                        [disabled]="isReadOnly || isLoading"
                        title="{{'ebwebApp.outWard.tooltipSave' | translate}}">
                    <i class="mdi mdi-briefcase-download"></i> <span
                    jhiTranslate="entity.action.save">Lưu</span></button>
                <button class="button-navigation" *ebHasAnyAuthority="['ROLE_ADMIN',isKho ? ROLE.MuaHangQuaKho_Them : ROLE.MuaHangKhongQuaKho_Them]" [disabled]="isReadOnly || isLoading"
                        (click)="checkBeforeSave(true)"
                        title="{{'ebwebApp.outWard.tooltipSaveAndAdd' | translate}}">
                    <i class="mdi mdi-plus"></i>
                    <span jhiTranslate="ebwebApp.purchaseOrder.saveAndAdd">Lưu & thêm</span>
                </button>
                <button *ebHasAnyAuthority="['ROLE_ADMIN',isKho ? ROLE.MuaHangQuaKho_GhiSo : ROLE.MuaHangKhongQuaKho_GhiSo, !pPInvoice.recorded]" class="button-navigation" (click)="recordPPI()"
                        [disabled]="!pPInvoice || !pPInvoice.id || isLoading || !isReadOnly"
                        title="{{'ebwebApp.outWard.tooltipRecord' | translate}}"><i class="mdi mdi-border-color"></i> <span
                    jhiTranslate="entity.action.write">ghi sổ</span></button>
                <button *ebHasAnyAuthority="['ROLE_ADMIN',isKho ? ROLE.MuaHangQuaKho_GhiSo : ROLE.MuaHangKhongQuaKho_GhiSo, pPInvoice.recorded]" class="button-navigation" (click)="checkUnRecord(unRecordModal)"
                        [disabled]="!pPInvoice || !pPInvoice.id || isLoading || checkCloseBook(account, pPInvoice.postedDate)"
                        title="{{'ebwebApp.outWard.tooltipUnRecord' | translate}}">
                    <i class="mdi mdi-pencil"></i>
                    <span jhiTranslate="ebwebApp.mBDeposit.home.unrecord">bỏ ghi sổ</span></button>
                <button class="button-navigation" *ebHasAnyAuthority="['ROLE_ADMIN',isKho ? ROLE.MuaHangQuaKho_Them : ROLE.MuaHangKhongQuaKho_Them]" (click)="copyAndNewPPI()" [disabled]="!isReadOnly || isLoading"
                        title="{{'ebwebApp.outWard.tooltipCopy&Add' | translate}}">
                    <i class="mdi mdi-plus"></i> <span
                    jhiTranslate="entity.action.copyAndAddNew">Sao chép & thêm</span></button>
                <button *ebHasAnyAuthority="['ROLE_ADMIN',isKho ? ROLE.MuaHangQuaKho_Xoa : ROLE.MuaHangKhongQuaKho_Xoa]" class="button-navigation" (click)="openModelDelete(deleteItem)"
                        title="{{'ebwebApp.outWard.tooltipDrop' | translate}}"
                        [disabled]="!isReadOnly || (!(pPInvoice && pPInvoice.id) || pPInvoice?.recorded) || isLoading">
                    <i class="mdi mdi-delete-forever"></i><span jhiTranslate="entity.action.delete">Xóa</span></button>
                <div ngbDropdown class="mdi d-inline-block">
                    <button
                        *ebHasAnyAuthority="['ROLE_ADMIN',isKho ? ROLE.MuaHangQuaKho_In : ROLE.MuaHangKhongQuaKho_In]"
                        [ngStyle]="{'color': isReadOnly ? '#fff' : '#959ea9', 'pointer-events': isReadOnly ? 'all' : 'none'}"
                        id="dropdownPrint" ngbDropdownToggle
                        style="background: transparent;border: none; color: #f0f0f0"><i
                        class="mdi mdi-printer"></i><span
                        jhiTranslate="ebwebApp.mBTellerPaper.print"></span>
                    </button>
                    <div
                        [ngStyle]="{'color': isReadOnly ? '#fff' : '#959ea9', 'pointer-events': isReadOnly ? 'all' : 'none'}"
                        ngbDropdownMenu aria-labelledby="dropdownPrint" style="padding: 0 !important; width: 180px"
                        *ngIf="pPInvoice.id && isReadOnly">
                        <button class="btn-dr-i hover-dr" style="border: none"
                                (click)="printPPI(false, PPINVOICE_TYPE.TYPE_REPORT_CHUNG_TU)"><span
                            jhiTranslate="ebwebApp.mBDeposit.financialPaper"></span></button>
                        <button class="btn-dr-i hover-dr" style="border: none"
                                *ngIf="pPInvoice.currencyId !== account.organizationUnit.currencyID"
                                (click)="printPPI(false, PPINVOICE_TYPE.TYPE_REPORT_CHUNG_TU_QD)"><span
                            jhiTranslate="ebwebApp.mBDeposit.financialPaperQD"></span></button>
                        <button class="btn-dr-i hover-dr" style="border: none"
                                *ngIf="pPInvoice.typeId === PPINVOICE_TYPE.TYPE_ID_UY_NHIEM_CHI
                                || pPInvoice.typeId === PPINVOICE_TYPE.TYPE_ID_SEC_CK
                                || pPInvoice.typeId === PPINVOICE_TYPE.TYPE_ID_SEC_TIEN_MAT"
                                (click)="printPPI(false, PPINVOICE_TYPE.TYPE_REPORT_BAO_NO)"><span
                            jhiTranslate="ebwebApp.pPInvoice.print.baoNo"></span></button>
                        <button class="btn-dr-i hover-dr" style="border: none" *ngIf="isPay && pPInvoice.typeId === PPINVOICE_TYPE.TYPE_ID_TIEN_MAT"
                                (click)="printPPI(false, PPINVOICE_TYPE.TYPE_REPORT_PHIEU_CHI)"><span
                            jhiTranslate="ebwebApp.pPInvoice.print.phieuChi"></span></button>
                        <button class="btn-dr-i hover-dr" style="border: none" *ngIf="isPay && pPInvoice.typeId === PPINVOICE_TYPE.TYPE_ID_TIEN_MAT"
                                (click)="printPPI(false, PPINVOICE_TYPE.TYPE_REPORT_PHIEU_CHI_A5)"><span
                            jhiTranslate="ebwebApp.pPInvoice.print.phieuChiA5"></span></button>
                        <button class="btn-dr-i hover-dr" *ngIf="isKho" style="border: none"
                                (click)="printPPI(false, PPINVOICE_TYPE.TYPE_REPORT_NHAP_KHO)"><span
                            jhiTranslate="ebwebApp.pPInvoice.print.nhapKho"></span></button>
                        <button class="btn-dr-i hover-dr" *ngIf="isKho" style="border: none"
                                (click)="printPPI(false, PPINVOICE_TYPE.TYPE_REPORT_NHAP_KHO_A5)"><span
                            jhiTranslate="ebwebApp.pPInvoice.phieuNhapKhoA5"></span></button>
                    </div>
                </div>
                <div ngbDropdown class="d-inline-block" style="margin-left: 10px">
                    <button
                            id="dropdownM" ngbDropdownToggle
                            style="background: transparent;border: none; color: #f0f0f0"><i
                        class="mdi mdi-plus-circle"></i><span
                        jhiTranslate="ebwebApp.saReturn.form"></span>
                    </button>
                    <div
                         ngbDropdownMenu aria-labelledby="dropdownM" style="padding: 0 !important;">
                        <button class="btn-dr-i hover-dr" [class.active]="!isMoreForm" (click)="isMoreForm = false"><span
                            jhiTranslate="ebwebApp.saReturn.basicForm"></span></button>
                        <button class="btn-dr-i hover-dr" [class.active]="isMoreForm" (click)="isMoreForm = true"><span
                            jhiTranslate="ebwebApp.saReturn.moreForm"></span></button>
                    </div>
                </div>
                <button class="button-navigation" style="margin-left: 10px" (click)="previousState(content)" [disabled]="isLoading"
                        title="{{'ebwebApp.outWard.tooltipBack' | translate}}">
                    <i class="mdi mdi-window-close"></i> <span
                    jhiTranslate="entity.action.close">Đóng</span></button>
            </div>
        </div>

        <div class="tool-navbar">
            <div class="row">
                <div class="col-lg-4">
                    <div class="line-btn" style="margin-bottom: 4px">
                        <div class="lbtn-action">
                            <ul class="nav nav-tabs top">
                                <li [ngClass]="active === 1 ? 'active' : ''" (click)="changeActive(1)">
                                    <a [ngClass]="active === 1 ? 'active' : ''" data-toggle="tab">
                                        <span jhiTranslate="ebwebApp.pPInvoice.chungTuMuaHang">Chứng từ mua hàng</span></a>
                                </li>
                                <li *ngIf="componentType === PPINVOICE_COMPONENT_TYPE.MUA_HANG_QUA_KHO" [ngClass]="active === 2 ? 'active' : ''" (click)="changeActive(2)">
                                    <a data-toggle="tab" [ngClass]="active === 2 ? 'active' : ''" >
                                        <span jhiTranslate="ebwebApp.pPInvoice.phieuNhapKho">Phiếu nhập kho</span>
                                    </a>
                                </li>
                                <li [ngClass]="active === 3 ? 'active' : ''" (click)="changeActive(3)" *ngIf="isPay">
                                    <a [ngClass]="active === 3 ? 'active' : ''" data-toggle="tab">
                                        <span *ngIf="pPInvoice.typeId === PPINVOICE_TYPE.TYPE_ID_TIEN_MAT" jhiTranslate="ebwebApp.pPInvoice.phieuChi">Phiếu chi</span>
                                        <span *ngIf="pPInvoice.typeId === PPINVOICE_TYPE.TYPE_ID_UY_NHIEM_CHI" jhiTranslate="ebwebApp.pPInvoice.uyNhiemChi">Ủy nhiệm chi  </span>
                                        <span *ngIf="pPInvoice.typeId === PPINVOICE_TYPE.TYPE_ID_SEC_CK" jhiTranslate="ebwebApp.pPInvoice.secChuyenKhoan">Séc chuyển khoản</span>
                                        <span *ngIf="pPInvoice.typeId === PPINVOICE_TYPE.TYPE_ID_SEC_TIEN_MAT" jhiTranslate="ebwebApp.pPInvoice.secTienMat">Séc tiền mặt  </span>
                                        <span *ngIf="pPInvoice.typeId === PPINVOICE_TYPE.TYPE_ID_THE_TIN_DUNG" jhiTranslate="ebwebApp.pPInvoice.theTinDung">Thẻ tín dụng</span>
                                    </a>
                                </li>
                            </ul>
                        </div>
                    </div>
                </div>
                <div class="col-lg-8">
                    <div class="row no-gutters">
                        <div class="form-group row col-sm-6 no-gutters" [class.disable]="isReadOnly">
                            <label style="display: inline-flex" class="radio-inline col-sm-4 offset-sm-4">
                                <input [disabled]="isReadOnly" type="radio" name="typeReset" [(ngModel)]="isPay" [value]="false" (ngModelChange)="changeIsPay()">
                                <span class="pl-2" style="line-height: 29px" jhiTranslate="ebwebApp.pPInvoice.noPay">Chưa thanh toán</span>
                            </label>
                            <label style="display: inline-flex" class="radio-inline col-md-4">
                                <input [disabled]="isReadOnly" type="radio" name="typeReset" [(ngModel)]="isPay" [value]="true" (ngModelChange)="changeIsPay()">
                                <span class="pl-2" style="line-height: 29px" jhiTranslate="ebwebApp.pPInvoice.payNow">Thanh toán ngay</span>
                            </label>
                        </div>
                        <div class="col-sm-2">
                            <select [disabled]="!isPay || isReadOnly"
                                    name="accountingObject0"
                                    id="field_typeid" [(ngModel)]="pPInvoice.typeId"
                                    (ngModelChange)="changeTypeId()"
                                    class="form-control form-control-sm noSetDisable">
                                <option [ngValue]="PPINVOICE_TYPE.TYPE_ID_CHUA_THANH_TOAN" disabled></option>
                                <option [ngValue]="PPINVOICE_TYPE.TYPE_ID_TIEN_MAT"
                                        jhiTranslate="ebwebApp.pPInvoice.cash">Tiền mặt
                                </option>
                                <option [ngValue]="PPINVOICE_TYPE.TYPE_ID_UY_NHIEM_CHI"
                                        jhiTranslate="ebwebApp.pPInvoice.uyNhiemChi">Ủy nhiệm chi
                                </option>
                                <option [ngValue]="PPINVOICE_TYPE.TYPE_ID_SEC_CK"
                                        jhiTranslate="ebwebApp.pPInvoice.secChuyenKhoan">Séc chuyển khoản
                                </option>
                                <option [ngValue]="PPINVOICE_TYPE.TYPE_ID_SEC_TIEN_MAT"
                                        jhiTranslate="ebwebApp.pPInvoice.secTienMat">Séc tiền mặt
                                </option>
                                <option [ngValue]="PPINVOICE_TYPE.TYPE_ID_THE_TIN_DUNG"
                                        jhiTranslate="ebwebApp.pPInvoice.theTinDung">Thẻ tín dụng
                                </option>
                            </select>
                        </div>
                        <label class="col-sm-2 form-check-label text-right" jhiTranslate="ebwebApp.pPInvoice.buy">Mua hàng</label>
                        <div class="col-sm-2">
                            <select name="accountingObjectType"
                                    [disabled]="isReadOnly"
                                    id="field_accountingObjectType"
                                    [(ngModel)]="pPInvoice.isImportPurchase"
                                    (ngModelChange)="changeImportPurchase()"
                                    class="form-control form-control-sm">
                                <option [ngValue]="false" selected jhiTranslate="ebwebApp.pPInvoice.domestic">Trong nước</option>
                                <option [ngValue]="true" jhiTranslate="ebwebApp.pPInvoice.import">Nhập khẩu</option>
                            </select>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        <div id="home0" style="padding-bottom: 10px">
            <div class="row no-gutters">
                <div class="col-lg-9 pd-r-0 form-main-new" *ngIf="active === 1">
                    <form>
                        <h3 jhiTranslate="ebwebApp.pPInvoice.generalInformation">Thông tin chung</h3>
                        <div class="row">
                            <div class="col-lg-12">
                                <div class="form-group row no-gutters">
                                    <label class="col-sm-2 col-form-label"
                                           for="field_accountingObject" jhiTranslate="ebwebApp.pPInvoice.object">Đối tượng</label>
                                    <div class="col-sm-3 pd-l-0 pr-0">
                                        <combo-box style="" id="field_accountingObject"
                                                   name="comboboxaccountingObject"
                                                   displayMember="accountingObjectCode"
                                                   [dataList]="accountingObjects"
                                                   [listColumns]="utilsService.listColumnsAccountingObjects"
                                                   valueName="id"
                                                   [headerColumns]="utilsService.listHeaderColumnsAccountingObject"
                                                   [isObject]="true"
                                                   [isOutTable]="true"
                                                   [(ngModel)]="pPInvoice.accountingObject"
                                                   (ngModelChange)="changeAccountingObject()"
                                                   [tabindex]="23+1"
                                                   [nameCategory]="utilsService.NHA_CUNG_CAP"
                                                   [showIconPlus]="true"
                                                   (click)="saveParent()"
                                        ></combo-box>
                                    </div>
                                    <div class="col-sm-8 pd-l-0 last-div-1-1">
                                        <input type="text" class="form-control form-control-sm"
                                               name="accountingObjectName"
                                               [(ngModel)]="pPInvoice.accountingObjectName"
                                               maxlength="512" [readOnly]="isReadOnly" [tabindex]="23+2">
                                    </div>
                                </div>
                                <div class="form-group row no-gutters">
                                    <label class="col-sm-2 col-form-label"
                                           for="field_accountingObjectAddress" jhiTranslate="ebwebApp.pPInvoice.address">Địa chỉ</label>
                                    <div class="col-sm-10 pd-l-0 last-div-1-0">
                                        <input type="text" class="form-control form-control-sm"
                                               name="accountingObjectAddress"
                                               id="field_accountingObjectAddress"
                                               [(ngModel)]="pPInvoice.accountingObjectAddress"
                                               maxlength="512" [readOnly]="isReadOnly" [tabindex]="23+3">
                                    </div>
                                </div>
                                <div class="form-group row no-gutters">
                                    <label class="col-sm-2 col-form-label" jhiTranslate="ebwebApp.pPInvoice.taxCode">Mã số thuế</label>
                                    <div class="col-sm-3 pd-l-0 pd-r-10">
                                        <input type="text" [readOnly]="isReadOnly" class="form-control form-control-sm"
                                               [(ngModel)]="pPInvoice.companyTaxCode" name="taxCode" [tabindex]="23+4">
                                    </div>
                                    <label class="col-sm-2 col-form-label"
                                           for="field_payers" jhiTranslate="ebwebApp.pPInvoice.contactName">Người
                                        giao</label>
                                    <div class="col-sm-2">
                                        <input type="text" class="form-control form-control-sm" name="payers"
                                               id="field_payers" [(ngModel)]="pPInvoice.contactName"
                                               maxlength="512" [readOnly]="isReadOnly" [tabindex]="23+5">
                                    </div>

                                    <label class="col-sm-2 col-form-label"
                                           jhiTranslate="ebwebApp.pPInvoice.dueDate">Hạn thanh toán</label>
                                    <div class="col-sm-4 last-div-3-2">
                                        <eb-date-picker [disabled]="isReadOnly" [(ngModel)]="pPInvoice.dueDate" [tabindex]="23+5"
                                                        name="field_date"></eb-date-picker>
                                    </div>
                                </div>
                                <div class="form-group row no-gutters">
                                    <label class="col-sm-2 col-form-label"
                                           for="field_reason" jhiTranslate="ebwebApp.pPInvoice.reason">Dễn dãi</label>
                                    <div class="col-sm-10 pd-l-0 last-div-1-0">
                                        <input type="text" class="form-control form-control-sm" name="reason"
                                               id="field_reason"  [(ngModel)]="pPInvoice.reason"
                                               maxlength="512" [readOnly]="isReadOnly" (ngModelChange)="isChangeReason = true" [tabindex]="23+6">
                                    </div>
                                </div>
                                <div class="form-group row no-gutters">
                                    <label class="col-sm-2 col-form-label" for="field_employeeID" jhiTranslate="ebwebApp.pPInvoice.employee">Nhân
                                        viên thực hiện</label>
                                    <div class="col-sm-3 pd-l-0 pr-0">
                                        <combo-box style="" id="field_employeeID"
                                                   name="comboboxEmployees"
                                                   [dataList]="employees"
                                                   [listColumns]="utilsService.listColumnsEmployees"
                                                   displayMember="accountingObjectCode"
                                                   valueName="id"
                                                   [headerColumns]="utilsService.listHeaderColumnsEmployees"
                                                   [isObject]="true"
                                                   [isOutTable]="true"
                                                   [(ngModel)]="pPInvoice.employee"
                                                   (ngModelChange)="selectEmployee()"
                                                   [tabindex]="23+7"
                                                   [nameCategory]="utilsService.NHAN_VIEN"
                                                   [showIconPlus]="true"
                                                   (click)="saveParent()"
                                        ></combo-box>
                                    </div>
                                    <label class="col-sm-2 col-form-label"
                                           for="number_attach" jhiTranslate="ebwebApp.pPInvoice.numberAttach">Kèm
                                        theo</label>
                                    <div class="col-sm-8 last-div-2-1">
                                        <input type="text" class="form-control form-control-sm"
                                               id="number_attach" [readOnly]="isReadOnly"
                                               name="numberAttach"
                                               [(ngModel)]="pPInvoice.numberAttach"
                                               (ngModelChange)="changeNumberAttach()" [tabindex]="23+8">
                                    </div>
                                </div>
                            </div>
                        </div>
                    </form>
                </div>

                <div class="col-lg-9 pd-r-0 form-main-new" *ngIf="active === 2">
                    <form>
                        <h3 jhiTranslate="ebwebApp.pPInvoice.generalInformation">Thông tin chung</h3>
                        <div class="row">
                            <div class="col-lg-12">
                                <div class="form-group row no-gutters">
                                    <label class="col-sm-2 col-form-label"
                                           for="field_accountingObjectRS" jhiTranslate="ebwebApp.pPInvoice.object">Đối tượng</label>
                                    <div class="col-sm-3 pd-l-0 pr-0">
                                        <combo-box style="" id="field_accountingObjectRS"
                                                   name="comboboxaccountingObjectRS"
                                                   displayMember="accountingObjectCode"
                                                   [dataList]="accountingObjects"
                                                   [listColumns]="utilsService.listColumnsAccountingObjects"
                                                   valueName="id"
                                                   [headerColumns]="utilsService.listHeaderColumnsAccountingObject"
                                                   [isOutTable]="true"
                                                   [isObject]="true"
                                                   [(ngModel)]="pPInvoice.accountingObject"
                                                   (ngModelChange)="changeAccountingObject()"
                                                   [tabindex]="23+9"
                                                   [nameCategory]="utilsService.NHA_CUNG_CAP"
                                                   [showIconPlus]="true"
                                                   (click)="saveParent()"
                                        ></combo-box>
                                    </div>
                                    <div class="col-sm-8 pd-l-0 last-div-1-1">
                                        <input type="text" class="form-control form-control-sm"
                                               name="accountingObjectNameRS"
                                               [(ngModel)]="pPInvoice.accountingObjectName"
                                               maxlength="512" [readOnly]="isReadOnly" [tabindex]="23+10">
                                    </div>
                                </div>
                                <div class="form-group row no-gutters">
                                    <label class="col-sm-2 col-form-label"
                                           for="field_accountingObjectAddressRS" jhiTranslate="ebwebApp.pPInvoice.address">Địa chỉ</label>
                                    <div class="col-sm-10 pd-l-0 last-div-1-0">
                                        <input type="text" class="form-control form-control-sm"
                                               name="accountingObjectAddressRS"
                                               id="field_accountingObjectAddressRS"
                                               [(ngModel)]="pPInvoice.accountingObjectAddress"
                                               maxlength="512" [readOnly]="isReadOnly" [tabindex]="23+11">
                                    </div>
                                </div>

                                <div class="form-group row no-gutters">
                                    <label class="col-sm-2 col-form-label" for="field_employeeID" jhiTranslate="ebwebApp.pPInvoice.employee">Nhân
                                        viên thực hiện</label>
                                    <div class="col-sm-3 pd-l-0 pr-0">
                                        <combo-box style="" id="field_employeeIDRS"
                                                   name="comboboxEmployeesRS"
                                                   [dataList]="employees"
                                                   [listColumns]="utilsService.listColumnsEmployees"
                                                   displayMember="accountingObjectCode"
                                                   valueName="id"
                                                   [headerColumns]="utilsService.listHeaderColumnsEmployees"
                                                   [isOutTable]="true"
                                                   [isObject]="true"
                                                   [(ngModel)]="pPInvoice.employee"
                                                   (ngModelChange)="selectEmployee()"
                                                   [tabindex]="23+12"
                                                   [nameCategory]="utilsService.NHAN_VIEN"
                                                   [showIconPlus]="true"
                                                   (click)="saveParent()"
                                        ></combo-box>
                                    </div>
                                    <label class="col-sm-2 col-form-label text-left"
                                           for="number_attach" jhiTranslate="ebwebApp.pPInvoice.contactName">Người giao</label>
                                    <div class="col-sm-8 last-div-2-1">
                                        <input type="text" class="form-control form-control-sm"
                                               id="number_payersRS" name="payersRS"
                                               [(ngModel)]="pPInvoice.contactName" [readOnly]="isReadOnly" [tabindex]="23+13">
                                    </div>
                                </div>
                                <div class="form-group row no-gutters">
                                    <label class="col-sm-2 col-form-label"
                                           for="field_reason" jhiTranslate="ebwebApp.pPInvoice.reasonInput">Lý do nhập</label>
                                    <div class="col-sm-10 pd-l-0 last-div-1-0">
                                        <input type="text" class="form-control form-control-sm" name="reasonRS"
                                               id="field_reasonRS"  [(ngModel)]="pPInvoice.reasonRs"
                                               maxlength="512" [readOnly]="isReadOnly" (ngModelChange)="isChangeReasonRs = true" [tabindex]="23+14">
                                    </div>
                                </div>
                                <div class="form-group row no-gutters">
                                    <label class="col-sm-2 col-form-label"
                                           for="number_attach" jhiTranslate="ebwebApp.pPInvoice.numberAttach">Kèm theo</label>
                                    <div class="col-sm-10 pd-l-0 last-div-1-0">
                                        <input type="text" class="form-control form-control-sm"
                                               id="number_attachRS" name="numberAttachRS"
                                               [(ngModel)]="pPInvoice.numberAttachRs" [readOnly]="isReadOnly" [tabindex]="23+15">
                                    </div>
                                </div>
                            </div>
                        </div>
                    </form>
                </div>

                <!-- tiền mặt-->
                <div class="col-lg-9 pd-r-0 form-main-new" *ngIf="active === 3 && pPInvoice.typeId === PPINVOICE_TYPE.TYPE_ID_TIEN_MAT">
                    <form>
                        <h3 jhiTranslate="ebwebApp.pPInvoice.generalInformation">Thông tin chung</h3>
                        <div class="row">
                            <div class="col-lg-12">
                                <div class="form-group row no-gutters">
                                    <label class="col-sm-2 col-form-label"
                                           jhiTranslate="ebwebApp.muaHang.muaDichVu.insertUpdate.accountObject"
                                           for="field-account-object-mc-payment">Accounting Object</label>
                                    <div class="col-sm-3 pd-l-0 pr-0">
                                        <combo-box id="field-account-object-mc-payment"
                                                   name="combobox-account-object"
                                                   displayMember="accountingObjectCode"
                                                   [dataList]="accountingObjects"
                                                   [listColumns]="utilsService.listColumnsAccountingObjects"
                                                   valueName="id"
                                                   [headerColumns]="utilsService.listHeaderColumnsAccountingObject"
                                                   [isOutTable]="true"
                                                   [isObject]="true"
                                                   [(ngModel)]="pPInvoice.accountingObject"
                                                   [nameCategory]="utilsService.NHA_CUNG_CAP"
                                                   [showIconPlus]="true"
                                                   (click)="saveParent()"
                                                   (ngModelChange)="changeAccountingObject()" [tabindex]="23+16">
                                        </combo-box>
                                    </div>
                                    <div class="col-sm-8 pd-l-0 last-div-1-1">
                                        <input type="text" class="form-control form-control-sm"
                                               name="accounting-object-name"
                                               [(ngModel)]="pPInvoice.accountingObjectName" maxlength="512"
                                               [readOnly]="isReadOnly" [tabindex]="23+17">
                                    </div>
                                </div>
                                <div class="form-group row no-gutters">
                                    <label class="col-sm-2 col-form-label"
                                           jhiTranslate="ebwebApp.muaHang.muaDichVu.insertUpdate.accountingObjectAddress"
                                    >Accounting Object Address</label>
                                    <div class="col-sm-10 pd-l-0 last-div-1-0">
                                        <input type="text" class="form-control form-control-sm"
                                               name="field-accounting-object-address"
                                               id="field-accounting-object-address-mc-payment"
                                               [(ngModel)]="pPInvoice.accountingObjectAddress"
                                               maxlength="512" [readOnly]="isReadOnly" [tabindex]="23+18">
                                    </div>
                                </div>
                                <div class="form-group row no-gutters">
                                    <label class="col-sm-2 col-form-label"
                                           jhiTranslate="ebwebApp.muaHang.muaDichVu.insertUpdate.companyTaxCode"
                                           for="field-accounting-object-tax-code-mc-payment"></label>
                                    <div class="col-sm-3 pd-l-0 pr-0">
                                        <input type="text" class="form-control form-control-sm"
                                               name="field-accounting-object-tax-code-mc-payment"
                                               id="field-accounting-object-tax-code-mc-payment"
                                               [(ngModel)]="pPInvoice.companyTaxCode"
                                               maxlength="512" [readOnly]="isReadOnly" [tabindex]="23+19">
                                    </div>
                                    <label class="col-sm-2 col-form-label"
                                           jhiTranslate="ebwebApp.mCPayment.receiver"
                                           for="field-receiver-mc-payment"></label>
                                    <div class="col-sm-8 last-div-2-1">
                                        <input type="text" class="form-control form-control-sm"
                                               name="field-receiver-mc-payment"
                                               id="field-receiver-mc-payment"
                                               [(ngModel)]="pPInvoice.receiverUserName"
                                               maxlength="512" [readOnly]="isReadOnly" [tabindex]="23+20">
                                    </div>
                                </div>
                                <div class="form-group row no-gutters">
                                    <label class="col-sm-2 col-form-label"
                                           jhiTranslate="ebwebApp.pPInvoice.employee">Nhân
                                        viên thực hiện</label>
                                    <div class="col-sm-3 pd-l-0">
                                        <combo-box style="" id="field-employee-id-mc-payment"
                                                   name="field-employee-id-mc-payment"
                                                   [dataList]="employees"
                                                   [listColumns]="utilsService.listColumnsEmployees"
                                                   displayMember="accountingObjectCode"
                                                   valueName="id"
                                                   [headerColumns]="utilsService.listHeaderColumnsEmployees"
                                                   [isOutTable]="true"
                                                   [isObject]="true"
                                                   [nameCategory]="utilsService.NHAN_VIEN"
                                                   [showIconPlus]="true"
                                                   (click)="saveParent()"
                                                   [(ngModel)]="pPInvoice.employee"
                                                   (ngModelChange)="selectEmployee()" [tabindex]="23+21">
                                        </combo-box>
                                    </div>
                                    <label class="col-sm-2 col-form-label"
                                           jhiTranslate="ebwebApp.muaHang.muaDichVu.insertUpdate.numberAttach"
                                           for="field-number-attach-mc-payment"></label>
                                    <div class="col-sm-8 last-div-2-1">
                                        <input type="text" class="form-control form-control-sm"
                                               name="field-number-attach-mc-payment"
                                               id="field-number-attach-mc-payment"
                                               [(ngModel)]="pPInvoice.otherNumberAttach"
                                               maxlength="512" [readOnly]="isReadOnly" [tabindex]="23+22">
                                    </div>
                                </div>
                                <div class="form-group row no-gutters">
                                    <label class="col-sm-2 col-form-label"
                                           jhiTranslate="ebwebApp.mCPayment.reason"
                                           for="field-reason-mc-payment"></label>
                                    <div class="col-sm-10 pd-l-0 last-div-1-0">
                                        <input type="text" class="form-control form-control-sm"
                                               name="field-reason-mc-payment"
                                               id="field-reason-mc-payment"
                                               [(ngModel)]="pPInvoice.otherReason"
                                               maxlength="512" [readOnly]="isReadOnly"
                                               (ngModelChange)="isChangeOtherReason = true" [tabindex]="23+24">
                                    </div>
                                </div>
                            </div>
                        </div>
                    </form>
                </div>
                <!--ủy nhiệm chi, sec tiền mặt, sec chuyển khoản-->
                <div class="col-lg-9 pd-r-0 form-main-new" *ngIf="active === 3
                && (pPInvoice.typeId === PPINVOICE_TYPE.TYPE_ID_UY_NHIEM_CHI
                || pPInvoice.typeId === PPINVOICE_TYPE.TYPE_ID_SEC_CK
                || pPInvoice.typeId === PPINVOICE_TYPE.TYPE_ID_SEC_TIEN_MAT)">
                    <form>
                        <h3 jhiTranslate="ebwebApp.muaHang.muaDichVu.insertUpdate.generalInfo"></h3>
                        <div class="row">
                            <div class="col-lg-12">
                                <div class="form-group row no-gutters">
                                    <label class="col-sm-2 col-form-label" for="field-mb-teller-paper-bank-account-detail"
                                           jhiTranslate="ebwebApp.mBTellerPaper.bankAccountDetails"
                                    ></label>
                                    <div class="col-sm-3 pd-l-0 pd-r-10">
                                        <combo-box id="field-mb-teller-paper-bank-account-detail"
                                                   name="field-mb-teller-paper-bank-account-detail"
                                                   [dataList]="bankAccountDetails"
                                                   [listColumns]="utilsService.listColumnsBankAccountDetails"
                                                   displayMember="bankAccount"
                                                   valueName="id"
                                                   [headerColumns]="[
                                                                translateService.instant('ebwebApp.comboBox.bankAccountDetails.bankAccount'),
                                                                translateService.instant('ebwebApp.comboBox.bankAccountDetails.bankName')
                                                            ]"
                                                   [isObject]="true"
                                                   [isOutTable]="true"
                                                   [(ngModel)]="pPInvoice.accountPayment"
                                                   (ngModelChange)="onChangeAccountPayment()" [tabindex]="23+25"
                                                   [nameCategory]="utilsService.TAI_KHOAN_NGAN_HANG"
                                                   [showIconPlus]="true"
                                                   (click)="saveParent()">
                                        </combo-box>
                                    </div>
                                    <div class="col-sm-8 pd-l-0 last-div-1-1">
                                        <input type="text" class="form-control form-control-sm"
                                               name="field-mb-teller-paper-name"
                                               [(ngModel)]="pPInvoice.accountPaymentName"
                                               maxlength="512" [readOnly]="isReadOnly" [tabindex]="23+26">
                                    </div>
                                </div>
                                <div class="form-group row no-gutters">
                                    <label class="col-sm-2 col-form-label" for="field-mb-teller-paper-reason"
                                           jhiTranslate="ebwebApp.mBTellerPaper.reason"
                                    ></label>
                                    <div class="col-sm-10 pd-l-0 last-div-1-0">
                                        <input type="text" class="form-control form-control-sm" name="reason"
                                               id="field-mb-teller-paper-reason"
                                               [(ngModel)]="pPInvoice.otherReason" maxlength="512" [readOnly]="isReadOnly" [tabindex]="23+27">
                                    </div>
                                </div>
                                <div class="form-group row no-gutters">
                                    <label *ngIf="pPInvoice.typeId !== PPINVOICE_TYPE.TYPE_ID_SEC_TIEN_MAT" class="col-sm-2 col-form-label" for="field-account-object-mb-teller-paper"
                                           jhiTranslate="ebwebApp.mBTellerPaper.accountingObject"
                                    ></label>
                                    <label *ngIf="pPInvoice.typeId === PPINVOICE_TYPE.TYPE_ID_SEC_TIEN_MAT" class="col-sm-2 col-form-label" for="field_accountingObject"
                                           jhiTranslate="ebwebApp.mBTellerPaper.paymentTo"
                                    >AccountingObject</label>
                                    <div class="col-sm-3 pd-l-0 pr-0">
                                        <combo-box id="field-account-object-mb-teller-paper"
                                                   name="combobox-account-object-mb-teller-paper"
                                                   [dataList]="accountingObjects"
                                                   [listColumns]="utilsService.listColumnsAccountingObjects"
                                                   displayMember="accountingObjectCode"
                                                   valueName="id"
                                                   [nameCategory]="'KhachHang-NhaCungCap'"
                                                   [headerColumns]="[
                                                                translateService.instant('ebwebApp.comboBox.accountingObjects.accountingObjectCode'),
                                                                translateService.instant('ebwebApp.comboBox.accountingObjects.accountingObjectName'),
                                                                translateService.instant('ebwebApp.comboBox.accountingObjects.accountingObjectAddress')
                                                            ]"
                                                   [isObject]="true"
                                                   [isOutTable]="true"
                                                   [(ngModel)]="pPInvoice.accountingObject"
                                                   (ngModelChange)="changeAccountingObject()" [tabindex]="23+28">
                                        </combo-box>
                                    </div>
                                    <div class="col-sm-8 pd-l-0 last-div-1-1">
                                        <input type="text" class="form-control form-control-sm"
                                               name="accounting-object-name-mb-teller-paper"
                                               [(ngModel)]="pPInvoice.accountingObjectName"
                                               maxlength="512" [readOnly]="isReadOnly" [tabindex]="23+29">
                                    </div>
                                </div>
                                <div class="form-group row no-gutters">
                                    <label *ngIf="pPInvoice.typeId !== PPINVOICE_TYPE.TYPE_ID_SEC_TIEN_MAT"
                                           class="col-sm-2 col-form-label" for="accounting-object-address-mb-teller-paper"
                                           jhiTranslate="ebwebApp.mBTellerPaper.accountingobjectaddress"
                                    ></label>
                                    <label *ngIf="pPInvoice.typeId === PPINVOICE_TYPE.TYPE_ID_SEC_TIEN_MAT"
                                           class="col-sm-2 col-form-label" for="accounting-object-address-mb-teller-paper"
                                           jhiTranslate="ebwebApp.mBTellerPaper.receiver"
                                    ></label>
                                    <div class="col-sm-10 pd-l-0 last-div-1-0">
                                        <input *ngIf="pPInvoice.typeId !== PPINVOICE_TYPE.TYPE_ID_SEC_TIEN_MAT"
                                               type="text" class="form-control form-control-sm"
                                               name="accounting-object-address-mb-teller-paper"
                                               id="accounting-object-address-mb-teller-paper"
                                               [(ngModel)]="pPInvoice.accountingObjectAddress"
                                               maxlength="512" [readOnly]="isReadOnly" [tabindex]="23+30">
                                        <input type="text" class="form-control form-control-sm"
                                               *ngIf="pPInvoice.typeId === PPINVOICE_TYPE.TYPE_ID_SEC_TIEN_MAT"
                                               name="bank-name-receiver"
                                               id="bank-name-receiver"
                                               [(ngModel)]="pPInvoice.accountReceiverFullName"
                                               maxlength="512" [readOnly]="isReadOnly" [tabindex]="23+31">
                                    </div>
                                </div>
                                <div class="form-group row no-gutters" *ngIf="pPInvoice.typeId !== PPINVOICE_TYPE.TYPE_ID_SEC_TIEN_MAT">
                                    <label class="col-sm-2 col-form-label"
                                           for="field-mb-teller-paper-bank-account-receiver"
                                           jhiTranslate="ebwebApp.mBTellerPaper.accountingObjectBankAccount"
                                    ></label>
                                    <div class="col-sm-3 pd-l-0 pr-0">
                                        <combo-box id="field-mb-teller-paper-bank-account-receiver"
                                                   name="field-mb-teller-paper-bank-account-receiver"
                                                   [dataList]="bankAccountDetailReceivers"
                                                   [listColumns]="utilsService.listColumnsAccountingObjectBankAccount"
                                                   displayMember="bankAccount"
                                                   [headerColumns]="[
                                                                translateService.instant('ebwebApp.comboBox.bankAccountDetails.bankAccount'),
                                                                translateService.instant('ebwebApp.comboBox.bankAccountDetails.bankName')
                                                            ]"
                                                   [isOutTable]="true"
                                                   [isObject]="true"
                                                   [(ngModel)]="pPInvoice.accountReceiver"
                                                   (ngModelChange)="onSelectBankAccountDetailReceiver()" [tabindex]="23+32">
                                        </combo-box>
                                    </div>
                                    <div class="col-sm-3">
                                        <input type="text" class="form-control form-control-sm"
                                               name="bank-name-receiver"
                                               [(ngModel)]="pPInvoice.accountReceiverName"
                                               maxlength="512" [readOnly]="isReadOnly" [tabindex]="23+33">
                                    </div>
                                    <label class="width-80px col-form-label"
                                           jhiTranslate="ebwebApp.pPInvoice.employee">Nhân viên thực hiện</label>
                                    <div class="last-div">
                                        <combo-box style="" id="field-employee-id-mb-teller-paper"
                                                   name="field-employee-id-mb-teller-paper"
                                                   [dataList]="employees"
                                                   [listColumns]="utilsService.listColumnsEmployees"
                                                   displayMember="accountingObjectCode"
                                                   valueName="id"
                                                   [headerColumns]="[
                                                                translateService.instant('ebwebApp.comboBox.employees.accountingObjectCode'),
                                                                translateService.instant('ebwebApp.comboBox.employees.accountingObjectName')
                                                            ]"
                                                   [isOutTable]="true"
                                                   [isObject]="true"
                                                   [(ngModel)]="pPInvoice.employee"
                                                   (ngModelChange)="selectEmployee()"
                                                   [nameCategory]="utilsService.NHAN_VIEN"
                                                   [showIconPlus]="true"
                                                   (click)="saveParent()"
                                                   [tabindex]="23+34">
                                        </combo-box>
                                    </div>
                                </div>
                                <div class="form-group row no-gutters" *ngIf="pPInvoice.typeId === PPINVOICE_TYPE.TYPE_ID_SEC_TIEN_MAT">
                                    <label class="col-sm-2 col-form-label" for="field_identificationno"
                                           jhiTranslate="ebwebApp.mBTellerPaper.identificationno"
                                    >IdentificationNo</label>
                                    <div class="col-sm-3 pd-l-0 pd-r-10">
                                        <input type="text" class="form-control form-control-sm"
                                               name="identificationno"
                                               id="field_identificationno"
                                               [(ngModel)]="pPInvoice.identificationNo"
                                               maxlength="30" [tabindex]="23+35">
                                    </div>
                                    <label class="col-sm-2 col-form-label" for="field_issuedate"
                                           jhiTranslate="ebwebApp.mBTellerPaper.issuedate">Issue Date</label>
                                    <div class="col-sm-2">
                                        <div class="input-group">
                                            <eb-date-picker id="field_issuedate"
                                                            [(ngModel)]="pPInvoice.issueDate" [tabindex]="23+36"
                                                            name="issueDate"></eb-date-picker>
                                        </div>
                                    </div>
                                    <label class="col-sm-2 col-form-label" for="field_issueby"
                                           jhiTranslate="ebwebApp.mBTellerPaper.issueby">Issue by</label>
                                    <div class="col-sm-4 last-div-3-2">
                                        <input type="text" class="form-control form-control-sm"
                                               name="issueby"
                                               id="field_issueby"
                                               [(ngModel)]="pPInvoice.issueBy"
                                               maxlength="512" [tabindex]="23+37">
                                    </div>
                                </div>
                            </div>
                        </div>
                    </form>
                </div>
                <!--thẻ ngân hàng-->
                <div class="col-lg-9 pd-r-0 form-main-new" *ngIf="active === 3 && pPInvoice.typeId === PPINVOICE_TYPE.TYPE_ID_THE_TIN_DUNG">
                    <form>
                        <h3 jhiTranslate="ebwebApp.muaHang.muaDichVu.insertUpdate.generalInfo"></h3>
                        <div class="row">
                            <div class="col-lg-12">
                                <div class="form-group row no-gutters">
                                    <label class="col-sm-2 col-form-label"
                                           jhiTranslate="ebwebApp.mBCreditCard.accountPay"></label>
                                    <div class="col-sm-3 pd-l-0 pd-r-10">
                                        <combo-box style="" class="padding" id="field_creditCard"
                                                   name="comboboxcreditCard"
                                                   [dataList]="creditCards"
                                                   [isOutTable]="true"
                                                   [listColumns]="utilsService.listColumnsCreditCard"
                                                   displayMember="creditCardNumber"
                                                   [headerColumns]="[
                                                                translateService.instant('ebwebApp.comboBox.creditCard.creditCardNumber'),
                                                                translateService.instant('ebwebApp.comboBox.creditCard.creditCardType')
                                                            ]"
                                                   valueName="creditCardNumber"
                                                   [isObject]="true"
                                                   [(ngModel)]="pPInvoice.creditCardItem"
                                                   (ngModelChange)="onChangeCreditCard()" [tabindex]="23+38"
                                                   [nameCategory]="utilsService.THE_TIN_DUNG"
                                                   [showIconPlus]="true"
                                                   (click)="saveParent()">
                                        </combo-box>
                                    </div>
                                    <div class="col-sm-3 form-inline">
                                        <label class="col-form-label" style="width: 100px"
                                               jhiTranslate="ebwebApp.mBCreditCard.typeCard"></label>
                                        <div style="max-width: calc(100% - 100px)">
                                            <input type="text" style="width: 100%" class="form-control form-control-sm padding"
                                                   name="creditCardType" id="field_creditCardType"
                                                   [(ngModel)]="pPInvoice.creditCardType" maxlength="512" [class.noEdit]="true" [tabindex]="23+39">
                                        </div>
                                    </div>

                                    <label class="col-form-label" style="width: 100px"
                                           jhiTranslate="ebwebApp.mBCreditCard.ownerCard"></label>
                                    <div class="last-div">
                                        <input type="text" class="form-control form-control-sm padding"
                                               name="creditCardObject" id="field_creditCardObject"
                                               [(ngModel)]="pPInvoice.ownerCreditCard" maxlength="512" [class.noEdit]="true" [tabindex]="23+40">
                                    </div>
                                </div>
                                <div class="form-group row no-gutters">
                                    <label class="col-sm-2 col-form-label"
                                           for="pp-service-reason-creadit-card"
                                           jhiTranslate="ebwebApp.mBCreditCard.autoPrinciple"></label>

                                    <div class="col-sm-10 pd-l-0 last-div-1-0">
                                        <input type="text" class="form-control form-control-sm" name="reason"
                                               id="pp-service-reason-creadit-card"
                                               [(ngModel)]="pPInvoice.otherReason" maxlength="512" [readOnly]="isReadOnly" [tabindex]="23+41">
                                    </div>
                                </div>
                                <div class="form-group row no-gutters">
                                    <label class="col-sm-2 col-form-label"
                                           for="field-account-object-creadit-card-option"
                                           jhiTranslate="ebwebApp.mBCreditCard.accountObjectReceive"></label>
                                    <div class="col-sm-3 pd-l-0">
                                        <combo-box id="field-account-object-creadit-card-option"
                                                   name="field-account-object-creadit-card-option"
                                                   [dataList]="accountingObjects"
                                                   [listColumns]="utilsService.listColumnsAccountingObjects"
                                                   displayMember="accountingObjectCode"
                                                   valueName="id"
                                                   [headerColumns]="[
                                                                translateService.instant('ebwebApp.comboBox.accountingObjects.accountingObjectCode'),
                                                                translateService.instant('ebwebApp.comboBox.accountingObjects.accountingObjectName'),
                                                                translateService.instant('ebwebApp.comboBox.accountingObjects.accountingObjectAddress')
                                                            ]"
                                                   [isOutTable]="true"
                                                   [isObject]="true"
                                                   [(ngModel)]="pPInvoice.accountingObject"
                                                   (ngModelChange)="changeAccountingObject()" [tabindex]="23+42">
                                        </combo-box>
                                    </div>
                                    <div class="col-sm-7 last-div-1-1">
                                        <input type="text" class="form-control form-control-sm"
                                               name="accountingObjectName"
                                               id="field_accounntingObjectName"
                                               [(ngModel)]="pPInvoice.accountingObjectName" maxlength="512"
                                               [readOnly]="isReadOnly" [tabindex]="23+43">
                                    </div>
                                </div>
                                <div class="form-group row no-gutters">
                                    <label class="col-sm-2 col-form-label"
                                           jhiTranslate="ebwebApp.mBCreditCard.accountingObjectAddress"
                                           for="field_accountingObjectAddress"></label>
                                    <div class="col-sm-10 pd-l-0 last-div-1-0">
                                        <input type="text" class="form-control form-control-sm"
                                               name="accountingObjectAddress"
                                               [(ngModel)]="pPInvoice.accountingObjectAddress" maxlength="512"
                                               [readOnly]="isReadOnly" [tabindex]="23+44">
                                    </div>
                                </div>
                                <div class="form-group row no-gutters">
                                    <label class="col-sm-2 col-form-label" for="field-creadit-card-bank-account-receiver"
                                           jhiTranslate="ebwebApp.mBCreditCard.accountReceive"></label>
                                    <div class="col-sm-3 pd-l-0 pd-r-10">
                                        <combo-box id="field-creadit-card-bank-account-receiver"
                                                   name="ffield-creadit-card-bank-account-receiver"
                                                   [dataList]="creditBankAccountDetailReceivers"
                                                   [listColumns]="utilsService.listColumnsAccountingObjectBankAccount"
                                                   displayMember="bankAccount"
                                                   valueName="id"
                                                   [headerColumns]="[
                                                                translateService.instant('ebwebApp.comboBox.bankAccountDetails.bankAccount'),
                                                                translateService.instant('ebwebApp.comboBox.bankAccountDetails.bankName')
                                                            ]"
                                                   [isOutTable]="true"
                                                   [isObject]="true"
                                                   [(ngModel)]="pPInvoice.bankAccountReceiverItem"
                                                   (ngModelChange)="onSelectBankAccountDetail()" [tabindex]="23+45">
                                        </combo-box>
                                    </div>
                                    <div class="col-sm-3 pd-l-0">
                                        <input type="text" class="form-control form-control-sm"
                                               name="accountingObjectBankName" id="field_accountingObjectBankName"
                                               [(ngModel)]="pPInvoice.bankAccountReceiverName" maxlength="512"
                                               [readOnly]="isReadOnly" [tabindex]="23+46">
                                    </div>
                                    <label class="width-80px col-form-label"
                                           jhiTranslate="ebwebApp.pPInvoice.employee">Nhân viên thực hiện</label>
                                    <div class="last-div">
                                        <combo-box style="" id="field-employee-credit-card-option"
                                                   name="field-employee-credit-card-option"
                                                   [dataList]="employees"
                                                   [listColumns]="utilsService.listColumnsEmployees"
                                                   displayMember="accountingObjectCode"
                                                   valueName="id"
                                                   [headerColumns]="[
                                                                translateService.instant('ebwebApp.comboBox.employees.accountingObjectCode'),
                                                                translateService.instant('ebwebApp.comboBox.employees.accountingObjectName')
                                                            ]"
                                                   [isOutTable]="true"
                                                   [isObject]="true"
                                                   [(ngModel)]="pPInvoice.employee"
                                                   (ngModelChange)="selectEmployee()"
                                                   [nameCategory]="utilsService.NHAN_VIEN"
                                                   [showIconPlus]="true"
                                                   (click)="saveParent()"
                                                   [tabindex]="23+47">
                                        </combo-box>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </form>
                </div>

                <div class="col-lg-4 pd-only-l-10 form-main-new">
                    <form style="padding-bottom: 8px;">
                        <h3 jhiTranslate="ebwebApp.pPInvoice.book">Chứng từ</h3>
                        <div class="row">
                            <div class="col-lg-12">
                                <div class="form-group row no-gutters">
                                    <label class="col-sm-4 col-form-label" jhiTranslate="ebwebApp.pPInvoice.noFBook">Số chứng từ</label>
                                    <div class="col-sm-8 last-div-1-0" *ngIf="active === 1">
                                        <input type="text" [(ngModel)]="pPInvoice.noFBook"
                                               class="form-control form-control-sm" name="No"
                                               [readOnly]="isReadOnly" [tabindex]="23+48">
                                    </div>
                                    <div class="col-sm-8 last-div-1-0" *ngIf="active === 2">
                                        <input type="text" [(ngModel)]="pPInvoice.noFBookRs"
                                               class="form-control form-control-sm" name="No"
                                               [readOnly]="isReadOnly" [tabindex]="23+49">
                                    </div>
                                    <div class="col-sm-8 last-div-1-0" *ngIf="active === 3">
                                        <input type="text" [(ngModel)]="pPInvoice.otherNoFBook"
                                               class="form-control form-control-sm" name="No"
                                               [readOnly]="isReadOnly" [tabindex]="23+50">
                                    </div>
                                </div>
                                <div class="form-group row no-gutters">
                                    <label class="col-sm-4 col-form-label"
                                           jhiTranslate="ebwebApp.pPInvoice.date">Ngày chứng từ</label>
                                    <div class="col-sm-8 last-div-1-0">
                                        <eb-date-picker [(ngModel)]="pPInvoice.date" (ngModelChange)="changeDate()" [tabindex]="23+51" name="field_date"></eb-date-picker>
                                    </div>
                                </div>
                                <div class="form-group row no-gutters">
                                    <label class="col-sm-4 col-form-label"
                                           jhiTranslate="ebwebApp.pPInvoice.postedDate">Ngày hạch toán</label>
                                    <div class="col-sm-8 last-div-1-0">
                                        <eb-date-picker [(ngModel)]="pPInvoice.postedDate" [tabindex]="23+52" name="postedDate"></eb-date-picker>
                                    </div>
                                </div>
                                <div class="form-group row no-gutters">
                                    <label class="col-sm-4 col-form-label" jhiTranslate="ebwebApp.pPInvoice.typeCurrency">Loại tiền</label>
                                    <div class="col-sm-3 pd-l-0">
                                        <combo-box style="" id="field_currencyID"
                                                   name="comboboxcurrencyID"
                                                   [dataList]="currencies"
                                                   [listColumns]="utilsService.listColumnsCurrency"
                                                   displayMember="currencyCode"
                                                   valueName="currencyCode"
                                                   [headerColumns]="utilsService.listHeaderColumnsCurrency"
                                                   [isObject]="true"
                                                   [isRequired]="true"
                                                   [(ngModel)]="currency"
                                                   [isOutTable]="true"
                                                   (ngModelChange)="selectCurrency()"
                                                   [tabindex]="23+53"
                                        ></combo-box>
                                    </div>
                                    <label class="col-form-label"
                                           style="width: 45px; text-align:center; padding-left: 0px; padding-right: 0px;"
                                           jhiTranslate="ebwebApp.pPInvoice.exchangeRate">Tỷ giá</label>
                                    <div class="col-sm-3 last-div-rate">
                                        <input name="exchangeRate" type="number" style="padding-left: 0px; padding-right: 0px;"
                                               class="form-control form-control-sm noSetDisable"
                                               [disabled]="!currency || (account.organizationUnit.currencyID === currency?.currencyCode)"
                                               [(ngModel)]="pPInvoice.exchangeRate" [readOnly]="isReadOnly" [required]="!pPInvoice.exchangeRate"
                                               ebCurrencyMask [systemOptions]="account?.systemOption" [type]="4"
                                               (ngModelChange)="changeExchangeRate()" [tabindex]="23+54">
                                    </div>
                                </div>
                                <div class="form-group row no-gutters" *ngIf="showVaoSo">
                                    <label class="col-sm-4 col-form-label" jhiTranslate="ebwebApp.pPInvoice.typeLedger">Vào sổ</label>
                                    <div class="col-sm-8 last-div-1-0">
                                        <select class="form-control" name="typeLedger" id="field_typeLedger" [tabindex]="23+55"
                                                [(ngModel)]="pPInvoice.typeLedger" [class.disable]="isReadOnly">
                                            <option [ngValue]="0" jhiTranslate="ebwebApp.pPInvoice.financialBook"
                                                    *ngIf="pPInvoice.currentBook && pPInvoice.currentBook === '0'">Sổ tài chính</option>
                                            <option [ngValue]="1" jhiTranslate="ebwebApp.pPInvoice.managementBook"
                                                    *ngIf="pPInvoice.currentBook && pPInvoice.currentBook === '1'">Sổ quản trị</option>
                                            <option [ngValue]="2" jhiTranslate="ebwebApp.pPInvoice.bothBooks">Cả 2 sổ</option>
                                        </select>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </form>
                </div>
            </div>
        </div>
        <!-- chi tiết-->
        <div>
            <ngb-tabset  class="tool-navbar" (tabChange)="beforeChange($event)">
                <ngb-tab>
                    <ng-template ngbTabTitle><span jhiTranslate="ebwebApp.pPInvoiceDetails.hangTien">Hàng tiền</span></ng-template>
                    <ng-template ngbTabContent>
                        <div class="tab-content">
                            <div class="frm-main frm-padding tab-pane fade in active show" id="home-detail"
                                 style="background: #cbdcf0">
                                <div id="table-scroll-detail" class="table-scroll">
                                    <table id="main-table-detail" class="main-table">
                                        <thead>
                                        <tr>
                                            <th scope="col" jhiTranslate="ebwebApp.pPInvoiceDetails.materialGoodsId">Mã hàng</th>
                                            <th scope="col" jhiTranslate="ebwebApp.pPInvoiceDetails.description">Tên hàng</th>
                                            <th *ngIf="componentType === PPINVOICE_COMPONENT_TYPE.MUA_HANG_QUA_KHO"
                                                scope="col" jhiTranslate="ebwebApp.pPInvoiceDetails.repositoryId">Kho</th>
                                            <th scope="col" jhiTranslate="ebwebApp.pPInvoiceDetails.debitAccount">TK nợ</th>
                                            <th scope="col" jhiTranslate="ebwebApp.pPInvoiceDetails.creditAccount">TK có</th>
                                            <th scope="col" jhiTranslate="ebwebApp.pPInvoiceDetails.accountingObjectId">ĐT hạch toán</th>
                                            <th scope="col" jhiTranslate="ebwebApp.pPInvoiceDetails.unitId">Đơn vị tính</th>
                                            <th scope="col" jhiTranslate="ebwebApp.pPInvoiceDetails.quantity">Số lượng</th>
                                            <th scope="col" jhiTranslate="ebwebApp.pPInvoiceDetails.unitPriceOriginal">Đơn giá</th>
                                            <th *ngIf="currency?.currencyCode !== account.organizationUnit.currencyID"
                                                scope="col" jhiTranslate="ebwebApp.pPInvoiceDetails.unitPrice">Đơn giá QĐ</th>
                                            <th *ngIf="isMoreForm" scope="col" jhiTranslate="ebwebApp.pPInvoiceDetails.mainUnitId">ĐVT chính</th>
                                            <th *ngIf="isMoreForm" scope="col" jhiTranslate="ebwebApp.pPInvoiceDetails.mainConvertRate">Tỷ lệ chuyển đổi</th>
                                            <th *ngIf="isMoreForm" scope="col" jhiTranslate="ebwebApp.pPInvoiceDetails.formula">Phép tính</th>
                                            <th *ngIf="isMoreForm" scope="col" jhiTranslate="ebwebApp.pPInvoiceDetails.mainQuantity">Số lượng theo ĐVC</th>
                                            <th *ngIf="isMoreForm" scope="col" jhiTranslate="ebwebApp.pPInvoiceDetails.mainUnitPrice">Đơn giá theo ĐVC</th>
                                            <th scope="col" jhiTranslate="ebwebApp.pPInvoiceDetails.amountOriginal">Thành tiền</th>
                                            <th *ngIf="currency?.currencyCode !== account.organizationUnit.currencyID"
                                                scope="col" jhiTranslate="ebwebApp.pPInvoiceDetails.amount">Thành tiền QĐ</th>
                                            <th scope="col" jhiTranslate="ebwebApp.pPInvoiceDetails.discountRate">Tỷ lệ CK</th>
                                            <th scope="col" jhiTranslate="ebwebApp.pPInvoiceDetails.discountAmountOriginal">Tiền CK</th>
                                            <th *ngIf="currency?.currencyCode !== account.organizationUnit.currencyID"
                                                scope="col" jhiTranslate="ebwebApp.pPInvoiceDetails.discountAmount">Tiền CK QĐ</th>
                                            <th scope="col" jhiTranslate="ebwebApp.pPInvoiceDetails.freightAmountOriginal">Chi phí mua</th>
                                            <th *ngIf="pPInvoice.isImportPurchase" scope="col" jhiTranslate="ebwebApp.pPInvoiceDetails.importTaxExpenseAmountOriginal">Chi phí trước HQ</th>
                                            <th scope="col" [jhiTranslate]="isKho ? 'ebwebApp.pPInvoice.totalInwardAmount' : 'ebwebApp.pPInvoice.totalValue'">Giá trị nhập kho</th>
                                            <th scope="col" jhiTranslate="ebwebApp.pPInvoiceDetails.lotNo">Số lô</th>
                                            <th scope="col" jhiTranslate="ebwebApp.pPInvoiceDetails.expiryDate">Hạn dùng</th>
                                            <th scope="col" jhiTranslate="ebwebApp.pPInvoiceDetails.ppOrderDetailId">Số đơn hàng</th>
                                        </tr>
                                        </thead>
                                        <tbody>

                                        <tr *ngFor="let detail of pPInvoice.ppInvoiceDetails; let i = index"
                                            oncontextmenu="return false;"
                                            (contextmenu)="onRightClick($event, pPInvoice.ppInvoiceDetails, detail, true, true, true)"
                                            (keydown.control.c)="copyRow(detail, 1)"
                                            (keydown.control.q)="viewMaterialGoodsSpecification(detail)"
                                            (keydown.control.insert)="addNewRow(1, true)"
                                            (keydown.control.delete)="keyPress(i, 1)"
                                            (keydown.arrowDown)="moveArrowDown($event, 24)"
                                            (keydown.arrowUp)="moveArrowUp($event,24)">
                                            <!-- mã hàng -->
                                            <td class="cell-Table">
                                                <combo-box style=""
                                                           idIp="materialGoods{{i}}"
                                                           nameIp="materialGoods{{i}}"
                                                           [dataList]="materialGoodss"
                                                           [listColumns]="utilsService.listColumnsMaterialGoods"
                                                           displayMember="materialGoodsCode"
                                                           valueName="id"
                                                           [headerColumns]="utilsService.listHeaderColumnsMaterialGoods"
                                                           [isObject]="true"
                                                           [isRequired]="true"
                                                           [isOutTable]="false"
                                                           [(ngModel)]="detail.materialGood"
                                                           [account]="account"
                                                           (ngModelChange)="selectChangeMaterialGoods(detail)"
                                                           [tabindex]="23 + (22 * i) + 56 + 1"
                                                           [nameCategory]="utilsService.VAT_TU_HANG_HOA"
                                                           [showIconPlus]="true"
                                                           (click)="saveDetails(i)"
                                                           (focusInput)="actionFocus(0, i)">
                                                </combo-box>
                                            </td>
                                            <!-- tên hàng -->
                                            <td class="cell-Table jsgrid-cell jsgrid-align-left" title="{{detail.description}}">
                                                <input type="text" class="input-Cell bg-transparent border-0"
                                                       name="description{{i}}"
                                                       id="description{{i}}" [readOnly]="isReadOnly"
                                                       [(ngModel)]="detail.description"
                                                       (ngModelChange)="changeDescription(detail)"
                                                       [tabindex]="23 + (22 * i) + 56 + 2"
                                                       (focus)="actionFocus(1, i)">
                                            </td>
                                            <td class="cell-Table" *ngIf="componentType === PPINVOICE_COMPONENT_TYPE.MUA_HANG_QUA_KHO"
                                                [class.eb-read-only]="detail.materialGood?.materialGoodsType === MATERIAL_GOODS_TYPE.SERVICE">
                                                <combo-box style=""
                                                           idIp="repository{{i}}"
                                                           nameIp="repository{{i}}"
                                                           [dataList]="repositorys"
                                                           [listColumns]="utilsService.listColumnsRepository"
                                                           displayMember="repositoryCode"
                                                           valueName="repositoryName"
                                                           [headerColumns]="utilsService.listHeaderRepository"
                                                           [isOutTable]="false"
                                                           [isObject]="true"
                                                           [(ngModel)]="detail.repository"
                                                           [isRequired]="isKho
                                                                    && detail.materialGood
                                                                    && detail.materialGood.materialGoodsType !== MATERIAL_GOODS_TYPE.SERVICE
                                                                    && detail.materialGood.materialGoodsType !== MATERIAL_GOODS_TYPE.DIFF
                                                                    && !detail.repositoryId"
                                                           (ngModelChange)="onSelectRepository(detail)"
                                                           [tabindex]="23 + (22 * i) + 56 + 3"
                                                           [nameCategory]="utilsService.KHO"
                                                           [showIconPlus]="true"
                                                           [isReadOnly]="detail.materialGood?.materialGoodsType === MATERIAL_GOODS_TYPE.SERVICE"
                                                           (click)="saveDetails(i)"
                                                           (focusInput)="actionFocus(2, i)">
                                                </combo-box>
                                            </td>
                                            <!-- tk nợ -->
                                            <td class="cell-Table jsgrid-align-center">
                                                <combo-box idIp="debitAccount"
                                                           nameIp="debitAccount{{i}}"
                                                           [dataList]="debitAccountList"
                                                           [listColumns]="utilsService.listColumnsAccountDefaults"
                                                           displayMember="accountNumber"
                                                           valueName="id"
                                                           [headerColumns]="utilsService.listHeaderColumnsAccountDefaults"
                                                           [isOutTable]="false"
                                                           [isObject]="true"
                                                           [isRequired]="true"
                                                           [(ngModel)]="detail.debitAccountItem"
                                                           (ngModelChange)="selectDebitAccountItem(detail)"
                                                           [tabindex]="23 + (22 * i) + 56 + 4"
                                                           (focusInput)="actionFocus(3, i)">
                                                </combo-box>
                                            </td>
                                            <!-- tk có -->
                                            <td class="cell-Table jsgrid-align-center">
                                                <combo-box idIp="creditAccount{{i}}"
                                                           nameIp="creditAccount{{i}}"
                                                           [dataList]="creditAccountList"
                                                           [listColumns]="utilsService.listColumnsAccountDefaults"
                                                           displayMember="accountNumber"
                                                           valueName="id"
                                                           [headerColumns]="utilsService.listHeaderColumnsAccountDefaults"
                                                           [isOutTable]="false"
                                                           [isObject]="true"
                                                           [isRequired]="true"
                                                           [(ngModel)]="detail.creditAccountItem"
                                                           (ngModelChange)="selectCreditAccountItem(detail)"
                                                           [tabindex]="23 + (22 * i) + 56 + 5"
                                                           (focusInput)="actionFocus(4, i)">
                                                </combo-box>
                                            </td>
                                            <!-- dt hoạch toán -->
                                            <td class="cell-Table jsgrid-align-center">
                                                <combo-box
                                                    idIp="accountingObjectHT{{i}}"
                                                    nameIp="accountingObjectHT{{i}}"
                                                    [dataList]="accountingObjects"
                                                    [listColumns]="utilsService.listColumnsAccountingObjects"
                                                    displayMember="accountingObjectCode"
                                                    valueName="id"
                                                    [headerColumns]="utilsService.listHeaderColumnsAccountingObject"
                                                    [isOutTable]="false"
                                                    [isObject]="true"
                                                    [(ngModel)]="detail.accountingObjectHd"
                                                    (ngModelChange)="selectChangeAccountingObjectsHD(detail)"
                                                    [tabindex]="23 + (22 * i) + 56 + 6"
                                                    (focusInput)="actionFocus(5, i)">
                                                </combo-box>
                                            </td>
                                            <!-- đơn vị tính -->
                                            <td class="cell-Table">
                                                <combo-box idIp="unit{{i}}"
                                                           nameIp="unit{{i}}"
                                                           [dataList]="detail.units"
                                                           [listColumns]="['unitName']"
                                                           displayMember="unitName"
                                                           valueName="id"
                                                           [headerColumns]="['Đơn vị tính']"
                                                           [isOutTable]="false"
                                                           [isObject]="true"
                                                           [(ngModel)]="detail.unit"
                                                           (ngModelChange)="selectUnit(detail)"
                                                           [tabindex]="23 + (22 * i) + 56 + 7"
                                                           (focusInput)="actionFocus(6, i)"></combo-box>
                                            </td>
                                            <!-- số lượng -->
                                            <td class="cell-Table">
                                                <input type="number" class="input-Cell bg-transparent border-0 text-right"
                                                       name="quantity{{i}}"
                                                       id="quantity{{i}}"
                                                       [(ngModel)]="detail.quantity" [readOnly]="isReadOnly"
                                                       (ngModelChange)="changeQuantity(detail)" [allowNegative]="false"
                                                       ebCurrencyMask [systemOptions]="account?.systemOption" [type]="3"
                                                       [tabindex]="23 + (22 * i) + 56 + 8"
                                                       (focus)="actionFocus(7, i)">
                                            </td>
                                            <!-- đơn giá -->
                                            <td class="cell-Table">
                                                <combo-box
                                                    idIp="unitPrice{{i}}"
                                                    nameIp="unitPrice{{i}}"
                                                    [dataList]="detail.unitPrices"
                                                    [listColumns]="['unitPriceOriginal']"
                                                    displayMember="unitPriceOriginal"
                                                    valueName="unitPriceOriginal"
                                                    [headerColumns]="['Đơn giá']"
                                                    [isObject]="false"
                                                    [isOutTable]="false"
                                                    [(ngModel)]="detail.unitPriceOriginal"
                                                    (ngModelChange)="selectUnitPriceOriginal(detail)"
                                                    [getValueDisplay]="true"
                                                    [valueIsNumber]="true"
                                                    [allowNegative]="false"
                                                    [account]="account"
                                                    [systemOptions]="account?.systemOption"
                                                    [type]="pPInvoice.currencyId !== currencyCode ? 2 : 1"
                                                    [tabindex]="23 + (22 * i) + 56 + 9"
                                                    (focusInput)="actionFocus(8, i)"></combo-box>
                                            </td>
                                            <!-- đơn giá quy đổi -->
                                            <td class="cell-Table" *ngIf="currency?.currencyCode !== account.organizationUnit.currencyID">
                                                <input type="number" class="input-Cell bg-transparent border-0 text-right"
                                                       id="unitPriceQd{{i}}"
                                                       name="unitPriceQd{{i}}" [readOnly]="isReadOnly"
                                                       [(ngModel)]="detail.unitPrice" [allowNegative]="false"
                                                       ebCurrencyMask [systemOptions]="account?.systemOption"
                                                       (ngModelChange)="changeUnitPrice(detail)"
                                                       [type]="1" [tabindex]="23 + (22 * i) + 56 + 10"
                                                       (focus)="actionFocus(9, i)">
                                            </td>
                                            <!-- đơn vị tính chính -->
                                            <td *ngIf="isMoreForm" class="cell-Table">
                                                <input type="text" class="input-Cell bg-transparent border-0"
                                                       name="mainUnitID{{i}}"
                                                       id="mainUnitID{{i}}"
                                                       [(ngModel)]="detail.mainUnitName" [class.noEdit]="true"
                                                       (focus)="actionFocus(10, i)">
                                            </td>
                                            <!-- tỷ lệ chuyển đổi -->
                                            <td *ngIf="isMoreForm" class="cell-Table jsgrid-align-right">
                                                <input type="number" class="input-Cell bg-transparent border-0"
                                                       name="mainConvertRate{{i}}"
                                                       id="mainConvertRate{{i}}"
                                                       [readOnly]="isReadOnly"
                                                       [(ngModel)]="detail.mainConvertRate" [allowNegative]="false"
                                                       (ngModelChange)="changeMainConvertRate(detail)"
                                                       ebCurrencyMask [systemOptions]="account?.systemOption" [type]="5"
                                                       [tabindex]="23 + (22 * i) + 56 + 11"
                                                       [class.noEdit]="!detail.mainUnitName || isReadOnly"
                                                       (focus)="actionFocus(11, i)">
                                            </td>
                                            <td *ngIf="isMoreForm" class="cell-Table jsgrid-cell jsgrid-align-left">
                                                <input type="text" class="input-Cell bg-transparent border-0"
                                                       name="formula{{i}}" [class.noEdit]="true"
                                                       [(ngModel)]="detail.formula">
                                            </td>
                                            <!-- số lượng theo đơn vị chính -->
                                            <td  *ngIf="isMoreForm" class="cell-Table">
                                                <input type="number" class="input-Cell bg-transparent border-0 text-right"
                                                       name="mainQuantity{{i}}"
                                                       id="mainQuantity{{i}}"
                                                       [readOnly]="isReadOnly" [allowNegative]="false"
                                                       [(ngModel)]="detail.mainQuantity" ebCurrencyMask [systemOptions]="account?.systemOption" [type]="3"
                                                       (ngModelChange)="changeMainQuantity(detail)" [tabindex]="23 + (22 * i) + 56 + 12"
                                                       (focus)="actionFocus(13, i)">
                                            </td>
                                            <!-- đơn giá theo đơn vị chính -->
                                            <td *ngIf="isMoreForm" class="cell-Table">
                                                <input type="number" class="input-Cell bg-transparent border-0 text-right"
                                                       name="mainUnitPrice{{i}}"
                                                       id="mainUnitPrice{{i}}"
                                                       [readOnly]="isReadOnly"
                                                       [(ngModel)]="detail.mainUnitPrice" [allowNegative]="false"
                                                       ebCurrencyMask [systemOptions]="account?.systemOption"
                                                       (ngModelChange)="changeMainUnitPrice(detail)"
                                                       [type]="1" [tabindex]="23 + (22 * i) + 56 + 13"
                                                       (focus)="actionFocus(14, i)">
                                            </td>
                                            <!-- thành tiền -->
                                            <td class="cell-Table">
                                                <input type="number" class="input-Cell bg-transparent border-0 text-right"
                                                       name="amountOriginal{{i}}"
                                                       id="amountOriginal{{i}}"
                                                       [readOnly]="isReadOnly"
                                                       [(ngModel)]="detail.amountOriginal"
                                                       (ngModelChange)="changeAmount(detail)" [allowNegative]="false"
                                                       ebCurrencyMask [systemOptions]="account?.systemOption"
                                                       [type]="pPInvoice.currencyId !== currencyCode ? 8 : 7"
                                                       [tabindex]="23 + (22 * i) + 56 + 14"
                                                       (focus)="actionFocus(15, i)">
                                            </td>
                                            <!-- thành tiền quy đổi -->
                                            <td class="cell-Table" *ngIf="currency?.currencyCode !== account.organizationUnit.currencyID">
                                                <input type="number" class="input-Cell bg-transparent border-0 text-right"
                                                       name="detailAmount{{i}}"
                                                       id="detailAmount{{i}}"
                                                       [readOnly]="isReadOnly"
                                                       [(ngModel)]="detail.amount" (ngModelChange)="changeAmountOriginal(detail)"
                                                       ebCurrencyMask [systemOptions]="account?.systemOption" [allowNegative]="false"
                                                       [type]="7"
                                                       [tabindex]="23 + (22 * i) + 56 + 15"
                                                       (focus)="actionFocus(16, i)">
                                            </td>
                                            <!-- tỉ lệ chiết khấu -->
                                            <td class="cell-Table jsgrid-align-right">
                                                <input type="number" class="input-Cell bg-transparent border-0"
                                                       name="discountRate{{i}}"
                                                       id="discountRate{{i}}"
                                                       [readOnly]="isReadOnly"
                                                       [(ngModel)]="detail.discountRate" (ngModelChange)="changeDiscountRate(detail)"
                                                       ebCurrencyMask [systemOptions]="account?.systemOption" [type]="5" [allowNegative]="false"
                                                       [tabindex]="23 + (22 * i) + 56 + 16"
                                                       (focus)="actionFocus(17, i)">
                                            </td>
                                            <!-- tiền chiết khấu -->
                                            <td class="cell-Table">
                                                <input type="number" class="input-Cell bg-transparent border-0 text-right"
                                                       name="discountAmountOriginal{{i}}"
                                                       id="discountAmountOriginal{{i}}"
                                                       [readOnly]="isReadOnly"
                                                       [(ngModel)]="detail.discountAmountOriginal"
                                                       (ngModelChange)="changeDiscountAmountOriginal(detail)"
                                                       ebCurrencyMask [systemOptions]="account?.systemOption"
                                                       [type]="pPInvoice.currencyId !== currencyCode ? 8 : 7" [allowNegative]="false"
                                                       [tabindex]="23 + (22 * i) + 56 + 17"
                                                       (focus)="actionFocus(18, i)">
                                            </td>
                                            <!-- tiền chiết khấu quy đổi -->
                                            <td class="cell-Table" *ngIf="currency?.currencyCode !== account.organizationUnit.currencyID">
                                                <input type="number" class="input-Cell bg-transparent border-0 text-right"
                                                       name="discountAmount{{i}}"
                                                       id="discountAmount{{i}}"
                                                       [readOnly]="isReadOnly"
                                                       [(ngModel)]="detail.discountAmount"
                                                       (ngModelChange)="changeDiscountAmount(detail)"
                                                       ebCurrencyMask [systemOptions]="account?.systemOption" [allowNegative]="false"
                                                       [type]="7"
                                                       [tabindex]="23 + (22 * i) + 56 + 18"
                                                       (focus)="actionFocus(19, i)">
                                            </td>
                                            <!-- chi phí mua -->
                                            <td class="cell-Table">
                                                <input type="number" class="input-Cell bg-transparent border-0 text-right"
                                                       name="freightAmount{{i}}"
                                                       id="freightAmount{{i}}"
                                                       [readOnly]="isReadOnly"
                                                       [(ngModel)]="detail.freightAmount" (ngModelChange)="changeFreightAmount(detail)"
                                                       ebCurrencyMask [systemOptions]="account?.systemOption" [allowNegative]="false"
                                                       [type]="7"
                                                       [tabindex]="23 + (22 * i) + 56 + 19"
                                                       (focus)="actionFocus(20, i)">
                                            </td>
                                            <!-- chi phí trước hải quan -->
                                            <td class="cell-Table" *ngIf="pPInvoice.isImportPurchase">
                                                <input type="number" class="input-Cell bg-transparent border-0 text-right"
                                                       name="importTaxExpenseAmount{{i}}"
                                                       id="importTaxExpenseAmount{{i}}"
                                                       [readOnly]="isReadOnly"
                                                       [(ngModel)]="detail.importTaxExpenseAmount"
                                                       (ngModelChange)="changeImportTaxExpenseAmount(detail)"
                                                       ebCurrencyMask [systemOptions]="account?.systemOption" [allowNegative]="false"
                                                       [type]="7"
                                                       [tabindex]="23 + (22 * i) + 56 + 20"
                                                       (focus)="actionFocus(21, i)">
                                            </td>
                                            <!-- giá nhập kho -->
                                            <td class="cell-Table jsgrid-align-right">
                                                <input type="number" class="input-Cell bg-transparent border-0 text-right"
                                                       [class.noEdit]="true"
                                                       name="inwardAmount{{i}}"
                                                       id="inwardAmount{{i}}"
                                                       [(ngModel)]="detail.inwardAmount"
                                                       (ngModelChange)="changeInwardAmount(detail)"
                                                       ebCurrencyMask [systemOptions]="account?.systemOption" disabled
                                                       [type]="7"
                                                       (focus)="actionFocus(22, i)">
                                            </td>
                                            <!-- số lô -->
                                            <td class="cell-Table">
                                                <input type="text" class="input-Cell bg-transparent border-0"
                                                       name="lotNo{{i}}"
                                                       id="lotNo{{i}}"
                                                       [readOnly]="isReadOnly"
                                                       [(ngModel)]="detail.lotNo" [tabindex]="23 + (22 * i) + 56 + 21"
                                                       (focus)="actionFocus(23, i)">
                                            </td>
                                            <!-- hạn dùng -->
                                            <td class="cell-Table jsgrid-align-center">
                                                <eb-date-picker [(ngModel)]="detail.expiryDate"
                                                                name="{{'expiryDate' + i }}"
                                                                idIp="expiryDate{{i}}"
                                                                [isInTable]="true"
                                                                [tabindex]="23 + (22 * i) + 56 + 22"
                                                                (keydown.tab)="addLastInput(i)"
                                                                (focusInput)="actionFocus(24, i)"></eb-date-picker>
                                            </td>
                                            <!-- số đơn hàng -->
                                            <td class="cell-Table">
                                                <input type="text" class="input-Cell bg-transparent border-0"
                                                       name="ppOrderDetail{{i}}" [class.noEdit]="true"
                                                       [(ngModel)]="detail.ppOrderNo" [tabindex]="23 + (24 * i) + 56 + 23">
                                            </td>
                                        </tr>
                                        <tr *ngIf="!isReadOnly" (click)="addNewRow(1)">
<!--                                            <td class="jsgrid-cell" jhiTranslate="ebwebApp.purchaseOrder.addNewLine">Thêm dòng mới...</td>-->
                                            <td class="jsgrid-cell"><input id="materialGoods" type="text" class="input-Cell"
                                                                           placeholder="{{'ebwebApp.purchaseOrder.addNewLine' | translate}}" readonly></td>
                                            <td class="jsgrid-cell jsgrid-align-right"><input id="description" type="text" class="input-Cell" readonly></td>
                                            <td *ngIf="componentType === PPINVOICE_COMPONENT_TYPE.MUA_HANG_QUA_KHO"
                                                class="jsgrid-cell jsgrid-align-right"><input id="repository" type="text" class="input-Cell" readonly></td>
                                            <td class="jsgrid-cell jsgrid-align-right"><input id="debitAccount" type="text" class="input-Cell" readonly></td>
                                            <td class="jsgrid-cell jsgrid-align-right"><input id="creditAccount" type="text" class="input-Cell" readonly></td>
                                            <td class="jsgrid-cell jsgrid-align-right"><input id="accountingObjectHT" type="text" class="input-Cell" readonly></td>
                                            <td class="jsgrid-cell jsgrid-align-right"><input id="unit" type="text" class="input-Cell" readonly></td>
                                            <td class="jsgrid-cell jsgrid-align-right"><input id="quantity" type="text" class="input-Cell" readonly></td>
                                            <td class="jsgrid-cell jsgrid-align-right"><input id="unitPrice" type="text" class="input-Cell" readonly></td>
                                            <td *ngIf="currency?.currencyCode !== account.organizationUnit.currencyID" class="jsgrid-cell jsgrid-align-right"><input id="unitPriceQd" type="text" class="input-Cell" readonly></td>
                                            <td *ngIf="isMoreForm" class="jsgrid-cell jsgrid-align-right"><input id="mainUnitID" type="text" class="input-Cell" readonly></td>
                                            <td *ngIf="isMoreForm" class="jsgrid-cell jsgrid-align-right"><input id="mainConvertRate" type="text" class="input-Cell" readonly></td>
                                            <td *ngIf="isMoreForm" class="jsgrid-cell jsgrid-align-right"><input id="formula" type="text" class="input-Cell" readonly></td>
                                            <td *ngIf="isMoreForm" class="jsgrid-cell jsgrid-align-right"><input id="mainQuantity" type="text" class="input-Cell" readonly></td>
                                            <td *ngIf="isMoreForm" class="jsgrid-cell jsgrid-align-right"><input id="mainUnitPrice" type="text" class="input-Cell" readonly></td>
                                            <td class="jsgrid-cell jsgrid-align-right"><input id="amountOriginal" type="text" class="input-Cell" readonly></td>
                                            <td *ngIf="currency?.currencyCode !== account.organizationUnit.currencyID" class="jsgrid-cell jsgrid-align-right"><input id="detailAmount" type="text" class="input-Cell" readonly></td>
                                            <td class="jsgrid-cell jsgrid-align-right"><input id="discountRate" type="text" class="input-Cell" readonly></td>
                                            <td class="jsgrid-cell jsgrid-align-right"><input id="discountAmountOriginal" type="text" class="input-Cell" readonly></td>
                                            <td *ngIf="currency?.currencyCode !== account.organizationUnit.currencyID" class="jsgrid-cell jsgrid-align-right"><input id="discountAmount" type="text" class="input-Cell" readonly></td>
                                            <td class="jsgrid-cell jsgrid-align-right"><input id="freightAmount" type="text" class="input-Cell" readonly></td>
                                            <td *ngIf="pPInvoice.isImportPurchase" class="jsgrid-cell jsgrid-align-right"><input id="importTaxExpenseAmount" type="text" class="input-Cell" readonly></td>
                                            <td class="jsgrid-cell jsgrid-align-right"><input id="inwardAmount" type="text" class="input-Cell" readonly></td>
                                            <td class="jsgrid-cell jsgrid-align-right"><input id="lotNo" type="text" class="input-Cell" readonly></td>
                                            <td class="jsgrid-cell jsgrid-align-right"><input id="expiryDate" type="text" class="input-Cell" readonly></td>
                                            <td class="jsgrid-cell jsgrid-align-right"><input id="ppOrderDetail" type="text" class="input-Cell" readonly></td>
                                        </tr>
                                        <tr *ngFor="let item of newArr(9-(pPInvoice.ppInvoiceDetails.length ? pPInvoice.ppInvoiceDetails.length : 0))">
                                            <td class="jsgrid-cell">&nbsp;</td>
                                            <td class="jsgrid-cell jsgrid-align-right">&nbsp;</td>
                                            <td *ngIf="componentType === PPINVOICE_COMPONENT_TYPE.MUA_HANG_QUA_KHO"
                                                class="jsgrid-cell jsgrid-align-right">&nbsp;</td>
                                            <td class="jsgrid-cell jsgrid-align-right">&nbsp;</td>
                                            <td class="jsgrid-cell jsgrid-align-right">&nbsp;</td>
                                            <td class="jsgrid-cell jsgrid-align-right">&nbsp;</td>
                                            <td class="jsgrid-cell jsgrid-align-right">&nbsp;</td>
                                            <td class="jsgrid-cell jsgrid-align-right">&nbsp;</td>
                                            <td class="jsgrid-cell jsgrid-align-right">&nbsp;</td>
                                            <td *ngIf="currency?.currencyCode !== account.organizationUnit.currencyID" class="jsgrid-cell jsgrid-align-right">&nbsp;</td>
                                            <td *ngIf="isMoreForm" class="jsgrid-cell jsgrid-align-right">&nbsp;</td>
                                            <td *ngIf="isMoreForm" class="jsgrid-cell jsgrid-align-right">&nbsp;</td>
                                            <td *ngIf="isMoreForm" class="jsgrid-cell jsgrid-align-right">&nbsp;</td>
                                            <td *ngIf="isMoreForm" class="jsgrid-cell jsgrid-align-right">&nbsp;</td>
                                            <td *ngIf="isMoreForm" class="jsgrid-cell jsgrid-align-right">&nbsp;</td>
                                            <td class="jsgrid-cell jsgrid-align-right">&nbsp;</td>
                                            <td *ngIf="currency?.currencyCode !== account.organizationUnit.currencyID" class="jsgrid-cell jsgrid-align-right">&nbsp;</td>
                                            <td class="jsgrid-cell jsgrid-align-right">&nbsp;</td>
                                            <td class="jsgrid-cell jsgrid-align-right">&nbsp;</td>
                                            <td *ngIf="currency?.currencyCode !== account.organizationUnit.currencyID" class="jsgrid-cell jsgrid-align-right">&nbsp;</td>
                                            <td class="jsgrid-cell jsgrid-align-right">&nbsp;</td>
                                            <td *ngIf="pPInvoice.isImportPurchase" class="jsgrid-cell jsgrid-align-right">&nbsp;</td>
                                            <td class="jsgrid-cell jsgrid-align-right">&nbsp;</td>
                                            <td class="jsgrid-cell jsgrid-align-right">&nbsp;</td>
                                            <td class="jsgrid-cell jsgrid-align-right">&nbsp;</td>
                                            <td class="jsgrid-cell jsgrid-align-right">&nbsp;</td>
                                        </tr>
                                        </tbody>
                                        <tfoot>
                                        <td colspan="2">
                                            <span class="color-tfoot pd-l-9"
                                                  jhiTranslate="ebwebApp.pPInvoice.totalRow" translateValues="{total: '{{pPInvoice.ppInvoiceDetails.length}}'}"></span>
                                        </td>
                                        <td colspan="1" *ngIf="componentType === PPINVOICE_COMPONENT_TYPE.MUA_HANG_QUA_KHO">
                                        </td>
                                        <td colspan="4"></td>
                                        <td class="text-right">
                                            <input type="number"
                                                   class="input-Cell text-right bg-transparent border-0"
                                                   [(ngModel)]="sumQuantity"
                                                   name="sumQuantity" ebCurrencyMask
                                                   [systemOptions]="account?.systemOption"
                                                   [type]="3" disabled>
                                        </td>
                                        <td class="text-right">
                                        </td>

                                        <td *ngIf="currency?.currencyCode !== account.organizationUnit.currencyID" class="text-right">
                                        </td>
                                        <td colspan="3" *ngIf="isMoreForm"></td>
                                        <td class="text-right" *ngIf="isMoreForm">
                                            <input type="number"
                                                   class="input-Cell text-right bg-transparent border-0 noSetDisable"
                                                   [(ngModel)]="sumMainQuantity"
                                                   name="sumMainQuantity" ebCurrencyMask
                                                   [systemOptions]="account?.systemOption"
                                                   [type]="3" disabled>
                                        </td>
                                        <td class="text-right" *ngIf="isMoreForm">
                                        </td>
                                        <td class="text-right">
                                            <input type="number"
                                                   class="input-Cell text-right bg-transparent border-0 noSetDisable"
                                                   [(ngModel)]="pPInvoice.totalAmountOriginal"
                                                   name="sumAmountOriginal" ebCurrencyMask
                                                   [systemOptions]="account?.systemOption" disabled
                                                   [type]="pPInvoice.currencyId !== currencyCode ? 8 : 7">
                                        </td>
                                        <td class="text-right" *ngIf="currency?.currencyCode !== account.organizationUnit.currencyID" >
                                            <input type="number"
                                                   class="input-Cell text-right bg-transparent border-0 noSetDisable"
                                                   [(ngModel)]="pPInvoice.totalAmount"
                                                   name="sumAmount"
                                                   *ngIf="currency?.currencyCode !== account.organizationUnit.currencyID"
                                                   ebCurrencyMask [systemOptions]="account?.systemOption" disabled
                                                   [type]="7">
                                        </td>
                                        <td class="text-right"></td>
                                        <td class="text-right">
                                            <input type="number"
                                                   class="input-Cell text-right bg-transparent border-0 noSetDisable"
                                                   [(ngModel)]="pPInvoice.totalDiscountAmountOriginal"
                                                   name="sumAmountOriginal" ebCurrencyMask
                                                   [systemOptions]="account?.systemOption" disabled
                                                   [type]="pPInvoice.currencyId !== currencyCode ? 8 : 7">
                                        </td>
                                        <td class="text-right" *ngIf="currency?.currencyCode !== account.organizationUnit.currencyID" >
                                            <input type="number"
                                                   class="input-Cell text-right bg-transparent border-0 noSetDisable"
                                                   [(ngModel)]="pPInvoice.totalDiscountAmount"
                                                   name="sumAmount"
                                                   *ngIf="currency?.currencyCode !== account.organizationUnit.currencyID"
                                                   ebCurrencyMask [systemOptions]="account?.systemOption" disabled
                                                   [type]="7">
                                        </td>
                                        <td class="text-right">
                                            <input type="number"
                                                   class="input-Cell text-right bg-transparent border-0 noSetDisable"
                                                   [(ngModel)]="pPInvoice.totalFreightAmount"
                                                   name="sumAmountOriginal" ebCurrencyMask
                                                   [systemOptions]="account?.systemOption" disabled
                                                   [type]="7">
                                        </td>
                                        <td class="text-right" *ngIf="pPInvoice.isImportPurchase">
                                            <input type="number"
                                                   class="input-Cell text-right bg-transparent border-0 noSetDisable"
                                                   [(ngModel)]="pPInvoice.totalImportTaxExpenseAmount"
                                                   name="sumAmountOriginal" ebCurrencyMask
                                                   [systemOptions]="account?.systemOption" disabled
                                                   [type]="7">
                                        </td>
                                        <td class="text-right">
                                            <input type="number"
                                                   class="input-Cell text-right bg-transparent border-0 noSetDisable"
                                                   [(ngModel)]="pPInvoice.totalInwardAmount"
                                                   name="sumAmountOriginal" ebCurrencyMask
                                                   [systemOptions]="account?.systemOption" disabled
                                                   [type]="7">
                                        </td>
                                        <td colspan="3"></td>
                                        </tfoot>
                                    </table>
                                </div>
                            </div>
                        </div>
                    </ng-template>
                </ngb-tab>

                <ngb-tab>
                    <ng-template ngbTabTitle><span jhiTranslate="ebwebApp.common.tax">Thuế</span></ng-template>
                    <ng-template ngbTabContent>
                        <div class="tab-content">
                            <div class="frm-main frm-padding tab-pane fade in active show" id="home-tax">
                                <div id="table-scroll-tax" class="table-scroll">
                                    <table id="main-table-tax" class="main-table">
                                        <thead>
                                        <tr>
                                            <th scope="col" jhiTranslate="ebwebApp.pPInvoiceDetails.materialGoodsId">Mã hàng</th>
                                            <th scope="col" jhiTranslate="ebwebApp.pPInvoiceDetails.vatDescription">Diễn giải thuế</th>
                                            <th scope="col" jhiTranslate="ebwebApp.pPInvoiceDetails.debitAccount">TK Nợ</th>
                                            <th scope="col" jhiTranslate="ebwebApp.pPInvoiceDetails.creditAccount">TK Có</th>
                                            <th scope="col" jhiTranslate="ebwebApp.pPInvoiceDetails.accountingObjectId">ĐT hạch toán</th>
                                            <th *ngIf="currency?.currencyCode !== account.organizationUnit.currencyID"
                                                scope="col" jhiTranslate="ebwebApp.pPInvoiceDetails.customUnitPrice">Giá tính thuế</th>
                                            <th *ngIf="pPInvoice.isImportPurchase"
                                                scope="col" jhiTranslate="ebwebApp.pPInvoiceDetails.importTaxRate">% thuế NK</th>
                                            <th *ngIf="pPInvoice.isImportPurchase"
                                                scope="col" jhiTranslate="ebwebApp.pPInvoiceDetails.importTaxAmountOriginal">Tiền thuế NK</th>
                                            <th *ngIf="pPInvoice.isImportPurchase"
                                                scope="col" jhiTranslate="ebwebApp.pPInvoiceDetails.importTaxAccount">TK thuế NK</th>
                                            <th scope="col" jhiTranslate="ebwebApp.pPInvoiceDetails.specialConsumeTaxRate">% thuế TTĐB</th>
                                            <th scope="col" jhiTranslate="ebwebApp.pPInvoiceDetails.specialConsumeTaxAmountOriginal">Tiền thuế TTĐB</th>
                                            <th scope="col" jhiTranslate="ebwebApp.pPInvoiceDetails.specialConsumeTaxAccount">TK thuế TTĐB</th>
                                            <th *ngIf="!taxCalculationMethod" scope="col" jhiTranslate="ebwebApp.pPInvoiceDetails.vatRate">Thuế suất thuế GTGT</th>
                                            <th *ngIf="!taxCalculationMethod" scope="col" jhiTranslate="ebwebApp.pPInvoiceDetails.vatAmountOriginal">Tiền thuế GTGT</th>
                                            <th *ngIf="((currency?.currencyCode !== account.organizationUnit.currencyID) && !pPInvoice.isImportPurchase) && !taxCalculationMethod"
                                                scope="col" jhiTranslate="ebwebApp.pPInvoiceDetails.vatAmount">Tiền thuế GTGT QĐ</th>
                                            <th *ngIf="!taxCalculationMethod" scope="col" jhiTranslate="ebwebApp.pPInvoiceDetails.vatAccount">TK thuế GTGT</th>
                                            <th *ngIf="!taxCalculationMethod" scope="col" jhiTranslate="ebwebApp.pPInvoiceDetails.deductionDebitAccount">TKĐƯ thuế GTGT</th>
                                            <th scope="col" jhiTranslate="ebwebApp.pPInvoiceDetails.invoiceTemplate">Mẫu số HĐ</th>
                                            <th scope="col" jhiTranslate="ebwebApp.pPInvoiceDetails.invoiceSeries">Ký hiệu HĐ</th>
                                            <th scope="col" jhiTranslate="ebwebApp.pPInvoiceDetails.invoiceNo">Số HĐ</th>
                                            <th scope="col" jhiTranslate="ebwebApp.pPInvoiceDetails.invoiceDate">Ngày HĐ</th>
                                            <th *ngIf="!taxCalculationMethod" scope="col" jhiTranslate="ebwebApp.pPInvoiceDetails.goodsServicePurchaseId">Nhóm HHDV mua vào</th>

                                        </tr>
                                        </thead>
                                        <tbody>
                                        <tr oncontextmenu="return false;"
                                            *ngFor="let detail of pPInvoice.ppInvoiceDetails; let i=index;"
                                            (contextmenu)="onRightClick($event, pPInvoice.ppInvoiceDetails, detail, true, true, true)"
                                            (keydown.control.insert)="addNewRow(1, true)"
                                            (keydown.control.c)="copyRow(detail, 1)"
                                            (keydown.control.q)="viewMaterialGoodsSpecification(detail)"
                                            (keydown.control.delete)="keyPress(i, 1)"
                                            (keydown.arrowDown)="moveArrowDown($event, 24)"
                                            (keydown.arrowUp)="moveArrowUp($event,24)">
                                            <!-- mã hàng -->
                                            <td class="cell-Table">
                                                <combo-box style=""
                                                           name="materialGood{{i}}"
                                                           nameIp="materialGoodTax{{i}}"
                                                           idIp="materialGoodTax{{i}}"
                                                           [dataList]="materialGoodss"
                                                           [listColumns]="utilsService.listColumnsMaterialGoods"
                                                           displayMember="materialGoodsCode"
                                                           valueName="id"
                                                           [headerColumns]="utilsService.listHeaderColumnsMaterialGoods"
                                                           [isObject]="true"
                                                           [isRequired]="true"
                                                           [isOutTable]="false"
                                                           [(ngModel)]="detail.materialGood"
                                                           (ngModelChange)="selectChangeMaterialGoods(detail)"
                                                           [tabindex]="23+(22 * i) + 56 + 1"
                                                           [nameCategory]="utilsService.VAT_TU_HANG_HOA"
                                                           [showIconPlus]="true"
                                                           (click)="saveDetails(i)"
                                                           (focusInput)="actionFocus(26, i)">
                                                </combo-box>
                                            </td>
                                            <!-- diễn giải thuế -->
                                            <td class="cell-Table jsgrid-cell jsgrid-align-left" title="{{ detail.vatDescription }}">
                                                <input type="text" class="input-Cell bg-transparent border-0"
                                                       name="vatDescription{{i}}"
                                                       id="vatDescription{{i}}"
                                                       [readOnly]="isReadOnly"
                                                       [(ngModel)]="detail.vatDescription"
                                                       [tabindex]="23+(22 * i) + 56 + 2"
                                                       (focus)="actionFocus(27, i)">
                                            </td>
                                            <!-- tk nợ -->
                                            <td class="cell-Table jsgrid-align-center">
                                                <combo-box idIp="debitAccountTax{{i}}"
                                                           nameIp="debitAccountTax{{i}}"
                                                           [dataList]="debitAccountList"
                                                           [listColumns]="utilsService.listColumnsAccountDefaults"
                                                           displayMember="accountNumber"
                                                           valueName="id"
                                                           [headerColumns]="utilsService.listHeaderColumnsAccountDefaults"
                                                           [isOutTable]="false"
                                                           [isObject]="true"
                                                           [isRequired]="true"
                                                           [(ngModel)]="detail.debitAccountItem"
                                                           (ngModelChange)="selectDebitAccountItem(detail)"
                                                           [tabindex]="23+(22 * i) + 56 + 3"
                                                           (focusInput)="actionFocus(28, i)">
                                                </combo-box>
                                            </td>
                                            <!-- tk có -->
                                            <td class="cell-Table jsgrid-align-center">
                                                <combo-box idIp="creditAccountTax{{i}}"
                                                           nameIp="creditAccountTax{{i}}"
                                                           [dataList]="creditAccountList"
                                                           [listColumns]="utilsService.listColumnsAccountDefaults"
                                                           displayMember="accountNumber"
                                                           valueName="id"
                                                           [headerColumns]="utilsService.listHeaderColumnsAccountDefaults"
                                                           [isOutTable]="false"
                                                           [isObject]="true"
                                                           [isRequired]="true"
                                                           [(ngModel)]="detail.creditAccountItem"
                                                           (ngModelChange)="selectCreditAccountItem(detail)"
                                                           [tabindex]="23+(22 * i) + 56 + 4"
                                                           (focusInput)="actionFocus(29, i)">
                                                </combo-box>
                                            </td>
                                            <!-- đối tượng hoạch toán -->
                                            <td class="cell-Table jsgrid-align-left">
                                                <combo-box
                                                    idIp="accountingObjectHTTax{{i}}"
                                                    nameIp="accountingObjectHTTax{{i}}"
                                                    [dataList]="accountingObjects"
                                                    [listColumns]="utilsService.listColumnsAccountingObjects"
                                                    displayMember="accountingObjectCode"
                                                    valueName="id"
                                                    [headerColumns]="utilsService.listHeaderColumnsAccountingObject"
                                                    [isOutTable]="false"
                                                    [isObject]="true"
                                                    [(ngModel)]="detail.accountingObjectHd"
                                                    (ngModelChange)="selectChangeAccountingObjectsHD(detail)"
                                                    [tabindex]="23+(22 * i) + 56 + 5"
                                                    (focusInput)="actionFocus(30, i)">
                                                </combo-box>
                                            </td>
                                            <!-- giá tính thuế -->
                                            <td class="cell-Table jsgrid-align-right" *ngIf="currency?.currencyCode !== account.organizationUnit.currencyID">
                                                <input type="number" class="input-Cell bg-transparent border-0 text-right"
                                                       name="customUnitPrice{{i}}"
                                                       id="customUnitPrice{{i}}"
                                                       [readOnly]="isReadOnly"
                                                       [(ngModel)]="detail.customUnitPrice"
                                                       (ngModelChange)="changeGiaTinhThue(detail)"
                                                       ebCurrencyMask [systemOptions]="account?.systemOption" [allowNegative]="false"
                                                       [type]="7"
                                                       [tabindex]="23+(22 * i) + 56 + 6"
                                                       (focus)="actionFocus(31, i)">
                                            </td>
                                            <!-- % thuế nhập khẩu -->
                                            <td class="cell-Table" *ngIf="pPInvoice.isImportPurchase">
                                                <input type="number" class="input-Cell bg-transparent border-0 text-right"
                                                       name="importTaxRate{{i}}"
                                                       id="importTaxRate{{i}}"
                                                       [readOnly]="isReadOnly"
                                                       [(ngModel)]="detail.importTaxRate" (ngModelChange)="changeImportTaxRate(detail)"
                                                       ebCurrencyMask [systemOptions]="account?.systemOption" [type]="5" [allowNegative]="false"
                                                       [tabindex]="23+(22 * i) + 56 + 7"
                                                       (focus)="actionFocus(32, i)">
                                            </td>
                                            <!-- tiền thuế nhập khẩu -->
                                            <td class="cell-Table" *ngIf="pPInvoice.isImportPurchase">
                                                <input type="number" class="input-Cell bg-transparent border-0 text-right"
                                                       name="importTaxAmount{{i}}"
                                                       id="importTaxAmount{{i}}"
                                                       [readOnly]="isReadOnly"
                                                       [(ngModel)]="detail.importTaxAmount" (ngModelChange)="changeImportTaxAmount(detail)"
                                                       ebCurrencyMask [systemOptions]="account?.systemOption" [allowNegative]="false"
                                                       [type]="7"
                                                       [tabindex]="23+(22 * i) + 56 + 8"
                                                       (focus)="actionFocus(33, i)">
                                            </td>
                                            <!-- tài khoản thuế nhập khẩu -->
                                            <td class="cell-Table jsgrid-align-center" *ngIf="pPInvoice.isImportPurchase">
                                                <combo-box idIp="importTaxAccountItem{{i}}"
                                                           nameIp="importTaxAccountItem{{i}}"
                                                           [dataList]="importTaxAccountList"
                                                           [listColumns]="utilsService.listColumnsAccountDefaults"
                                                           displayMember="accountNumber"
                                                           valueName="id"
                                                           [headerColumns]="utilsService.listHeaderColumnsAccountDefaults"
                                                           [isOutTable]="false"
                                                           [isObject]="true"
                                                           [(ngModel)]="detail.importTaxAccountItem"
                                                           [isRequired]="(detail.importTaxAmount && !isReadOnly)"
                                                           (ngModelChange)="selectImportTaxAccountItem(detail)"
                                                           [tabindex]="23+(22 * i) + 56 + 9"
                                                           (focusInput)="actionFocus(34, i)">
                                                </combo-box>
                                            </td>
                                            <!-- % thuế TTDB -->
                                            <td class="cell-Table">
                                                <input type="number" class="input-Cell bg-transparent border-0 text-right"
                                                       name="specialConsumeTaxRate{{i}}"
                                                       id="specialConsumeTaxRate{{i}}"
                                                       [readOnly]="isReadOnly"
                                                       [(ngModel)]="detail.specialConsumeTaxRate" (ngModelChange)="changeSpecialConsumeTaxRate(detail)"
                                                       ebCurrencyMask [systemOptions]="account?.systemOption" [type]="5" [allowNegative]="false"
                                                       [tabindex]="23+(22 * i) + 56 + 10"
                                                       (focus)="actionFocus(35, i)">
                                            </td>
                                            <!-- tiền thuế TTDB -->
                                            <td class="cell-Table">
                                                <input type="number" class="input-Cell bg-transparent border-0 text-right"
                                                       name="specialConsumeTaxAmount{{i}}"
                                                       id="specialConsumeTaxAmount{{i}}"
                                                       [readOnly]="isReadOnly"
                                                       [(ngModel)]="detail.specialConsumeTaxAmount" (ngModelChange)="changeSpecialConsumeTaxAmount(detail)"
                                                       ebCurrencyMask [systemOptions]="account?.systemOption" [allowNegative]="false"
                                                       [type]="7"
                                                       [tabindex]="23+(22 * i) + 56 + 11"
                                                       (focus)="actionFocus(36, i)">
                                            </td>
                                            <!-- tài khoản thuế TTDB -->
                                            <td class="cell-Table jsgrid-align-center">
                                                <combo-box idIp="specialConsumeTaxAccountItem{{i}}"
                                                           nameIp="specialConsumeTaxAccountItem{{i}}"
                                                           [dataList]="specialConsumeTaxAccountList"
                                                           [listColumns]="utilsService.listColumnsAccountDefaults"
                                                           displayMember="accountNumber"
                                                           valueName="id"
                                                           [headerColumns]="utilsService.listHeaderColumnsAccountDefaults"
                                                           [isOutTable]="false"
                                                           [isObject]="true"
                                                           [(ngModel)]="detail.specialConsumeTaxAccountItem"
                                                           [isRequired]="(detail.specialConsumeTaxAmount && !isReadOnly)"
                                                           (ngModelChange)="selectSpecialConsumeTaxAccountItem(detail)"
                                                           [tabindex]="23+(22 * i) + 56 + 12"
                                                           (focusInput)="actionFocus(37, i)">
                                                </combo-box>
                                            </td>
                                            <!-- %thuế GTGT -->
                                            <td *ngIf="!taxCalculationMethod" class="cell-Table jsgrid-align-right">
                                                <combo-box class="text-right"
                                                           nameIp="vatRate{{i}}"
                                                           idIp="vatRate{{i}}"
                                                           [dataList]="dataVATRate"
                                                           [isRemoveValue]="true"
                                                           [autoFillFistMatch]="true"
                                                           [listColumns]="['name']"
                                                           displayMember="name"
                                                           valueName="data"
                                                           [headerColumns]="['Dữ liệu']"
                                                           [(ngModel)]="detail.vatRate"
                                                           [isOutTable]="false"
                                                           (ngModelChange)="changeVatRate(detail)"
                                                           [tabindex]="23 + (22 * i) + 56 + 13"
                                                           (focusInput)="actionFocus(38, i)">
                                                ></combo-box>
                                            </td>
                                            <!-- tiền thuế GTGT -->
                                            <td class="cell-Table" *ngIf="!pPInvoice.isImportPurchase && !taxCalculationMethod">
                                                <input type="number" class="input-Cell bg-transparent border-0 text-right"
                                                       name="vatAmountOriginal{{i}}"
                                                       id="vatAmountOriginal{{i}}"
                                                       [readOnly]="isReadOnly"
                                                       [(ngModel)]="detail.vatAmountOriginal" (ngModelChange)="changeVatAmountOriginal(detail)"
                                                       ebCurrencyMask [systemOptions]="account?.systemOption"
                                                       [type]="pPInvoice.currencyId !== currencyCode ? 8 : 7"
                                                       [tabindex]="23+(22 * i) + 56 + 14"
                                                       (focus)="actionFocus(39, i)">
                                            </td>
                                            <!-- tiền thuế GTGT QĐ -->
                                            <td class="cell-Table" *ngIf="((currency?.currencyCode !== account.organizationUnit.currencyID) || pPInvoice.isImportPurchase) && !taxCalculationMethod">
                                                <input type="number" class="input-Cell bg-transparent border-0 text-right"
                                                       name="vatAmount{{i}}"
                                                       id="vatAmount{{i}}"
                                                       [readOnly]="isReadOnly"
                                                       [(ngModel)]="detail.vatAmount" (ngModelChange)="changeVatAmount(detail)"
                                                       ebCurrencyMask [systemOptions]="account?.systemOption"
                                                       [type]="7"
                                                       [tabindex]="23+(22 * i) + 56 + 15"
                                                       (focus)="actionFocus(40, i)">
                                            </td>
                                            <!-- tài khoản thuế GTGT -->
                                            <td *ngIf="!taxCalculationMethod" class="cell-Table jsgrid-align-center">
                                                <combo-box idIp="vatAccountItem{{i}}"
                                                           nameIp="vatAccountItem{{i}}"
                                                           [dataList]="vatAccountList"
                                                           [listColumns]="utilsService.listColumnsAccountDefaults"
                                                           displayMember="accountNumber"
                                                           valueName="id"
                                                           [headerColumns]="utilsService.listHeaderColumnsAccountDefaults"
                                                           [isOutTable]="false"
                                                           [isObject]="true"
                                                           [(ngModel)]="detail.vatAccountItem"
                                                           [isRequired]="(detail.vatAmountOriginal && !isReadOnly)"
                                                           (ngModelChange)="selectVatAccountItem(detail)"
                                                           [tabindex]="23+(22 * i) + 56 + 16"
                                                           (focusInput)="actionFocus(41, i)">
                                                </combo-box>
                                            </td>
                                            <!-- TKDƯ thuế GTGT -->
                                            <td *ngIf="!taxCalculationMethod" class="cell-Table jsgrid-align-center">
                                                <combo-box idIp="deductionDebitAccountItem1{{i}}"
                                                           nameIp="deductionDebitAccountItem1{{i}}"
                                                           [dataList]="deductionDebitAccountList"
                                                           [listColumns]="utilsService.listColumnsAccountDefaults"
                                                           displayMember="accountNumber"
                                                           valueName="id"
                                                           [headerColumns]="utilsService.listHeaderColumnsAccountDefaults"
                                                           [isOutTable]="false"
                                                           [isObject]="true"
                                                           [(ngModel)]="detail.deductionDebitAccountItem"
                                                           [isRequired]="(detail.vatAmountOriginal && !isReadOnly)"
                                                           (ngModelChange)="selectDeductionDebitAccountItem(detail)"
                                                           [tabindex]="23+(22 * i) + 56 + 17"
                                                           (focusInput)="actionFocus(42, i)">
                                                </combo-box>
                                            </td>
                                            <!-- mẫu số hợp đồng -->
                                            <td class="cell-Table">
                                                <combo-box name="invoiceTemplate {{i}}"
                                                           id="invoiceTemplate {{i}}"
                                                           [listColumns]="utilsService.listColumnInvoiceType"
                                                           [headerColumns]="utilsService.listHeaderColumnInvoiceType"
                                                           displayMember="invoiceTypeCode"
                                                           valueName="ID"
                                                           [dataList]="invoiceTypes"
                                                           [isObject]="false"
                                                           [isOutTable]="true"
                                                           [getValueDisplay]="true"
                                                           [isReadOnly]="!pPInvoice.billReceived || isReadOnly"
                                                           [(ngModel)]="detail.invoiceTemplate"
                                                           (ngModelChange)="changInvoiceInvoiceTemplate(detail)"
                                                           [tabindex]="(22 * i) + 56 + 18"
                                                           (focusInput)="actionFocus(42, i)">
                                                </combo-box>
                                            </td>
                                            <!-- ký hiệu hợp đồng -->
                                            <td class="cell-Table">
                                                <input type="text" class="input-Cell bg-transparent border-0"
                                                       name="invoiceSeries{{i}}"
                                                       id="invoiceSeries{{i}}"
                                                       [(ngModel)]="detail.invoiceSeries" [class.noEdit]="!pPInvoice.billReceived || isReadOnly"
                                                       (ngModelChange)="changInvoiceSeries(detail)"
                                                       [tabindex]="23+(22 * i) + 56 + 19"
                                                       (focus)="actionFocus(44, i)">
                                            </td>
                                            <!-- số hóa đơn -->
                                            <td class="cell-Table">
                                                <input type="text" class="input-Cell bg-transparent border-0"
                                                       name="invoiceNo{{i}}"
                                                       id="invoiceNo{{i}}"
                                                       [(ngModel)]="detail.invoiceNo" [class.noEdit]="!pPInvoice.billReceived || isReadOnly"
                                                       [tabindex]="23+(22 * i) + 56 + 20"
                                                       (focus)="actionFocus(45, i)"
                                                       [required]="pPInvoice.billReceived"
                                                        >
                                            </td>
                                            <!-- ngày hóa đơn -->
                                            <td class="cell-Table jsgrid-align-center" [class.eb-read-only]="!pPInvoice.billReceived || isReadOnly">
                                                <!--                                                <input type="date" class="input-Cell"-->
                                                <!--                                                       name="invoiceDate{{i}}" placeholder="dd/MM/yyyy"-->
                                                <!--                                                       id="invoiceDate{{i}}"-->
                                                <!--                                                       [(ngModel)]="detail.invoiceDate" [readOnly]="!pPInvoice.billReceived || isReadOnly">-->
                                                <eb-date-picker [(ngModel)]="detail.invoiceDate"
                                                                name="{{'invoiceDate' + i}}"
                                                                idIp="invoiceDate{{i}}"
                                                                [isInTable]="true" [disabled]="!pPInvoice.billReceived || isReadOnly"
                                                                [tabindex]="(!pPInvoice.billReceived || isReadOnly) ? -1 :  (23+(22 * i) + 56 + 21)"
                                                                (focusInput)="actionFocus(46, i)"
                                                                [isRequired]="pPInvoice.billReceived"></eb-date-picker>
                                            </td>

                                            <!-- Nhóm HHDV mua vào-->
                                            <td class="cell-Table" *ngIf="!taxCalculationMethod">
                                                <combo-box
                                                    idIp="goodsServicePurchase{{i}}"
                                                    nameIp="goodsServicePurchase{{i}}"
                                                    [dataList]="goodsServicePurchases"
                                                    [listColumns]="utilsService.listColumnsGoodsServicePurchase"
                                                    displayMember="goodsServicePurchaseCode"
                                                    valueName="id"
                                                    [headerColumns]="utilsService.listHeaderColumnsGoodsServicePurchase"
                                                    [isOutTable]="false"
                                                    [isObject]="true"
                                                    [(ngModel)]="detail.goodsServicePurchase"
                                                    (ngModelChange)="selectGoodsServiceObjects(detail)"
                                                    [tabindex]="23+(22 * i) + 56 + 22"
                                                    (keydown.tab)="addLastInput(i)"
                                                    (focusInput)="actionFocus(47, i)">
                                                </combo-box>
                                            </td>
                                        </tr>
                                        <tr *ngIf="!isReadOnly" (click)="addNewRow(1)">
                                            <td class="jsgrid-cell"><input id="materialGoodTax" type="text" class="input-Cell"
                                                       placeholder="{{'ebwebApp.purchaseOrder.addNewLine' | translate}}" readonly></td>
                                            <td class="jsgrid-cell jsgrid-align-right"><input id="vatDescription" type="text" class="input-Cell" readonly></td>
                                            <td class="jsgrid-cell jsgrid-align-right"><input id="debitAccountTax" type="text" class="input-Cell" readonly></td>
                                            <td class="jsgrid-cell jsgrid-align-right"><input id="creditAccountTax" type="text" class="input-Cell" readonly></td>
                                            <td class="jsgrid-cell jsgrid-align-right"><input id="accountingObjectHTTax" type="text" class="input-Cell" readonly></td>
                                            <td class="jsgrid-cell jsgrid-align-right"  *ngIf="currency?.currencyCode !== account.organizationUnit.currencyID"><input id="customUnitPrice" type="text" class="input-Cell" readonly></td>
                                            <td class="jsgrid-cell jsgrid-align-right"  *ngIf="pPInvoice.isImportPurchase"><input id="importTaxRate" type="text" class="input-Cell" readonly></td>
                                            <td class="jsgrid-cell jsgrid-align-right"  *ngIf="pPInvoice.isImportPurchase"><input id="importTaxAmount" type="text" class="input-Cell" readonly></td>
                                            <td class="jsgrid-cell jsgrid-align-right"  *ngIf="pPInvoice.isImportPurchase"><input id="importTaxAccountItem" type="text" class="input-Cell" readonly></td>
                                            <td class="jsgrid-cell jsgrid-align-right" ><input id="specialConsumeTaxRate" type="text" class="input-Cell" readonly></td>
                                            <td class="jsgrid-cell jsgrid-align-right" ><input id="specialConsumeTaxAmount" type="text" class="input-Cell" readonly></td>
                                            <td class="jsgrid-cell jsgrid-align-right" ><input id="specialConsumeTaxAccountItem" type="text" class="input-Cell" readonly></td>
                                            <td class="jsgrid-cell jsgrid-align-right"  *ngIf="!taxCalculationMethod"><input id="vatRate" type="text" class="input-Cell" readonly></td>
                                            <td class="jsgrid-cell jsgrid-align-right"  *ngIf="!pPInvoice.isImportPurchase && !taxCalculationMethod"><input id="vatAmountOriginal" type="text" class="input-Cell" readonly></td>
                                            <td class="jsgrid-cell jsgrid-align-right"  *ngIf="((currency?.currencyCode !== account.organizationUnit.currencyID) || pPInvoice.isImportPurchase) && !taxCalculationMethod">
                                                <input id="vatAmount" type="text" class="input-Cell" readonly></td>
                                            <td class="jsgrid-cell jsgrid-align-right"  *ngIf="!taxCalculationMethod"><input id="vatAccountItem" type="text" class="input-Cell" readonly></td>
                                            <td class="jsgrid-cell jsgrid-align-right"  *ngIf="!taxCalculationMethod"><input id="deductionDebitAccountItem" type="text" class="input-Cell" readonly></td>
                                            <td class="jsgrid-cell jsgrid-align-right" ><input id="invoiceTemplate" type="text" class="input-Cell" readonly></td>
                                            <td class="jsgrid-cell jsgrid-align-right" ><input id="invoiceSeries" type="text" class="input-Cell" readonly></td>
                                            <td class="jsgrid-cell jsgrid-align-right" ><input id="invoiceNo" type="text" class="input-Cell" readonly></td>
                                            <td class="jsgrid-cell jsgrid-align-right" ><input id="invoiceDate" type="text" class="input-Cell" readonly></td>
                                            <td class="jsgrid-cell jsgrid-align-right" *ngIf="!taxCalculationMethod"><input id="goodsServicePurchase" type="text" class="input-Cell" readonly></td>
                                        </tr>
                                        <tr *ngFor="let item of newArr(10-(pPInvoice.ppInvoiceDetails ? pPInvoice.ppInvoiceDetails.length : 0))">
                                            <td class="jsgrid-cell jsgrid-align-right" >&nbsp;</td>
                                            <td class="jsgrid-cell jsgrid-align-right" >&nbsp;</td>
                                            <td class="jsgrid-cell jsgrid-align-right" >&nbsp;</td>
                                            <td class="jsgrid-cell jsgrid-align-right" >&nbsp;</td>
                                            <td class="jsgrid-cell jsgrid-align-right" >&nbsp;</td>
                                            <td class="jsgrid-cell jsgrid-align-right"  *ngIf="currency?.currencyCode !== account.organizationUnit.currencyID">&nbsp;</td>
                                            <td class="jsgrid-cell jsgrid-align-right"  *ngIf="pPInvoice.isImportPurchase">&nbsp;</td>
                                            <td class="jsgrid-cell jsgrid-align-right"  *ngIf="pPInvoice.isImportPurchase">&nbsp;</td>
                                            <td class="jsgrid-cell jsgrid-align-right"  *ngIf="pPInvoice.isImportPurchase">&nbsp;</td>
                                            <td class="jsgrid-cell jsgrid-align-right" >&nbsp;</td>
                                            <td class="jsgrid-cell jsgrid-align-right" >&nbsp;</td>
                                            <td class="jsgrid-cell jsgrid-align-right" >&nbsp;</td>
                                            <td class="jsgrid-cell jsgrid-align-right"  *ngIf="!taxCalculationMethod">&nbsp;</td>
                                            <td class="jsgrid-cell jsgrid-align-right"  *ngIf="!pPInvoice.isImportPurchase && !taxCalculationMethod">&nbsp;</td>
                                            <td class="jsgrid-cell jsgrid-align-right"  *ngIf="((currency?.currencyCode !== account.organizationUnit.currencyID) || pPInvoice.isImportPurchase) && !taxCalculationMethod">&nbsp;</td>
                                            <td class="jsgrid-cell jsgrid-align-right"  *ngIf="!taxCalculationMethod">&nbsp;</td>
                                            <td class="jsgrid-cell jsgrid-align-right"  *ngIf="!taxCalculationMethod">&nbsp;</td>
                                            <td class="jsgrid-cell jsgrid-align-right" >&nbsp;</td>
                                            <td class="jsgrid-cell jsgrid-align-right" >&nbsp;</td>
                                            <td class="jsgrid-cell jsgrid-align-right" >&nbsp;</td>
                                            <td class="jsgrid-cell jsgrid-align-right" >&nbsp;</td>
                                            <td class="jsgrid-cell jsgrid-align-right"  *ngIf="!taxCalculationMethod">&nbsp;</td>
                                        </tr>
                                        </tbody>
                                        <tfoot>
                                        <td colspan="5">&nbsp;
                                            <span class="color-tfoot"
                                                  jhiTranslate="ebwebApp.pPInvoice.totalRow" translateValues="{total: '{{pPInvoice.ppInvoiceDetails.length}}'}"></span>
                                        </td>
                                        <td class="text-right" *ngIf="currency?.currencyCode !== account.organizationUnit.currencyID">
                                            <input type="number"
                                                   class="input-Cell text-right bg-transparent border-0 noSetDisable"
                                                   [(ngModel)]="sumCustomUnitPrice"
                                                   name="sumQuantity" ebCurrencyMask
                                                   [systemOptions]="account?.systemOption" disabled
                                                   [type]="7">
                                        </td>
                                        <td colspan="1" *ngIf="pPInvoice.isImportPurchase"></td>
                                        <td class="text-right" *ngIf="pPInvoice.isImportPurchase">
                                            <input type="number"
                                                   class="input-Cell text-right bg-transparent border-0 noSetDisable"
                                                   [(ngModel)]="pPInvoice.totalImportTaxAmount"
                                                   name="sumQuantity" ebCurrencyMask
                                                   [systemOptions]="account?.systemOption" disabled
                                                   [type]="7">
                                        </td>
                                        <td colspan="1" *ngIf="pPInvoice.isImportPurchase"></td>
                                        <td colspan="1"></td>
                                        <td class="text-right">
                                            <input type="number"
                                                   class="input-Cell text-right bg-transparent border-0 noSetDisable"
                                                   [(ngModel)]="pPInvoice.totalSpecialConsumeTaxAmount"
                                                   name="sumUnitPriceOriginal" ebCurrencyMask
                                                   [systemOptions]="account?.systemOption" disabled
                                                   [type]="7">
                                        </td>
                                        <td colspan="1"></td>
                                        <td *ngIf="!taxCalculationMethod" colspan="1"></td>
                                        <td class="text-right" *ngIf="!pPInvoice.isImportPurchase && !taxCalculationMethod">
                                            <input type="number"
                                                   class="input-Cell text-right bg-transparent border-0 noSetDisable"
                                                   [(ngModel)]="pPInvoice.totalVATAmountOriginal"
                                                   name="sumUnitPriceOriginal" ebCurrencyMask
                                                   [systemOptions]="account?.systemOption" disabled
                                                   [type]="pPInvoice.currencyId !== currencyCode ? 8 : 7">
                                        </td>
                                        <td class="text-right" *ngIf="((currency?.currencyCode !== account.organizationUnit.currencyID) || pPInvoice.isImportPurchase) && !taxCalculationMethod">
                                            <input type="number"
                                                   class="input-Cell text-right bg-transparent border-0 noSetDisable"
                                                   [(ngModel)]="pPInvoice.totalVATAmount"
                                                   name="sumUnitPriceOriginal" ebCurrencyMask
                                                   [systemOptions]="account?.systemOption" disabled
                                                   [type]="7">
                                        </td>
                                        <td *ngIf="!taxCalculationMethod" colspan="2"></td>
                                        <td colspan="4"></td>
                                        <td colspan="1" *ngIf="!taxCalculationMethod"></td>
                                        </tfoot>
                                    </table>
                                </div>
                            </div>
                        </div>
                    </ng-template>
                </ngb-tab>
                <ngb-tab>
                    <ng-template ngbTabTitle><span jhiTranslate="ebwebApp.common.statistical">Thống kê</span></ng-template>
                    <ng-template ngbTabContent>
                        <div class="tab-content">
                            <div class="frm-main frm-padding tab-pane fade in active show" id="home-report"
                                 style="background: #cbdcf0">
                                <div id="table-scroll-report" class="table-scroll">
                                    <table id="main-table-report" class="main-table">
                                        <thead>
                                        <tr>
                                            <th scope="col" jhiTranslate="ebwebApp.pPDiscountReturnDetails.materialGoodsID">
                                                Mã
                                                hàng
                                            </th>
                                            <th scope="col" jhiTranslate="ebwebApp.pPDiscountReturnDetails.description">Tên
                                                hàng
                                            </th>
                                            <th scope="col" jhiTranslate="ebwebApp.pPDiscountReturnDetails.expenseItemID">
                                                Khoản
                                                mục CP
                                            </th>
                                            <th scope="col" jhiTranslate="ebwebApp.pPDiscountReturnDetails.costSetID">Đối
                                                tượng
                                                THCP
                                            </th>
<!--                                            <th scope="col" jhiTranslate="ebwebApp.pPDiscountReturnDetails.contractID">Hợp-->
<!--                                                đồng-->
<!--                                            </th>-->
                                            <th scope="col" jhiTranslate="ebwebApp.pPDiscountReturnDetails.budgetItemID">mục
                                                thu
                                                chi
                                            </th>
                                            <th scope="col" jhiTranslate="ebwebApp.pPDiscountReturnDetails.departmentID">
                                                Phòng
                                                ban
                                            </th>
                                            <th scope="col"
                                                jhiTranslate="ebwebApp.pPDiscountReturnDetails.statisticsCodeID">Hợp
                                                đồng
                                            </th>
                                        </tr>
                                        </thead>
                                        <tbody>
                                        <tr>
                                        <tr oncontextmenu="return false;"
                                            *ngFor="let detail of pPInvoice.ppInvoiceDetails; let i=index;"
                                            (contextmenu)="onRightClick($event, pPInvoice.ppInvoiceDetails, detail, true, true, true)"
                                            (keydown.control.insert)="addNewRow(1, true)"
                                            (keydown.control.c)="copyRow(detail, 1)"
                                            (keydown.control.q)="viewMaterialGoodsSpecification(detail)"
                                            (keydown.control.delete)="keyPress(i, 1)"
                                            (keydown.arrowDown)="moveArrowDown($event, 8)"
                                            (keydown.arrowUp)="moveArrowUp($event,8)">
                                            <!-- mã hàng -->
                                            <td class="cell-Table">
                                                <combo-box style=""
                                                           nameIp="materialGoodTK{{i}}"
                                                           idIp="materialGoodTK{{i}}"
                                                           [dataList]="materialGoodss"
                                                           [listColumns]="utilsService.listColumnsMaterialGoods"
                                                           displayMember="materialGoodsCode"
                                                           valueName="materialGoodsCode"
                                                           [headerColumns]="utilsService.listHeaderMaterialGoodsForPPservices"
                                                           [isOutTable]="false"
                                                           [isObject]="true"
                                                           [(ngModel)]="detail.materialGood"
                                                           (ngModelChange)="selectChangeMaterialGoods(detail)"
                                                           [tabindex]="23+(8 * i) + 56 + 1"
                                                           [nameCategory]="utilsService.VAT_TU_HANG_HOA"
                                                           [showIconPlus]="true"
                                                           (click)="saveDetails(i)"
                                                           (focusInput)="actionFocus(48, i)">
                                                </combo-box>
                                            </td>
                                            <!-- tên hàng -->
                                            <td class="cell-Table jsgrid-cell jsgrid-align-left" title="{{ detail.description }}">
                                                <input type="text" class="input-Cell bg-transparent border-0"
                                                       name="descriptionTK{{i}}"
                                                       id="descriptionTK{{i}}"
                                                       [readOnly]="isReadOnly"
                                                       [(ngModel)]="detail.description"
                                                       [tabindex]="23+(8 * i) + 56 + 2"
                                                       (focus)="actionFocus(49, i)">
                                            </td>
                                            <!-- khoản mục-->
                                            <td class="cell-Table">
                                                <combo-box idIp="expenseItem{{i}}"
                                                           nameIp="expenseItem{{i}}"
                                                           [dataList]="expenseItemList"
                                                           [listColumns]="utilsService.listColumnsExpenseItem"
                                                           displayMember="expenseItemCode"
                                                           valueName="id"
                                                           [headerColumns]="utilsService.listHeaderColumnsExpenseItem"
                                                           [isOutTable]="false"
                                                           [isObject]="true"
                                                           [(ngModel)]="detail.expenseItem"
                                                           (ngModelChange)="selectChangeExpenseItem(detail)"
                                                           [tabindex]="23+(8 * i) + 56 + 3"
                                                           [nameCategory]="utilsService.KHOAN_MUC_CHI_PHI"
                                                           [showIconPlus]="true"
                                                           (click)="saveDetails(i)"
                                                           (focusInput)="actionFocus(50, i)">
                                                </combo-box>
                                            </td>
                                            <!--  Đối tượng THCP-->
                                            <td class="cell-Table">
                                                <combo-box idIp="costSetItem{{i}}"
                                                           nameIp="costSetItem{{i}}"
                                                           [dataList]="costSetList"
                                                           [listColumns]="utilsService.listColumnsCostSet"
                                                           displayMember="costSetCode"
                                                           valueName="id"
                                                           [headerColumns]="utilsService.listHeaderColumnsCostSet"
                                                           [isOutTable]="false"
                                                           [isObject]="true"
                                                           [(ngModel)]="detail.costSetItem"
                                                           (ngModelChange)="selectChangeCostSetItem(detail)"
                                                           [tabindex]="23+(8 * i) + 56 + 4"
                                                           [nameCategory]="utilsService.DOI_TUONG_TAP_HOP_CHI_PHI"
                                                           [showIconPlus]="true"
                                                           (click)="saveDetails(i)"
                                                           (focusInput)="actionFocus(51, i)">
                                                </combo-box>
                                            </td>
                                            <!-- Hợp đồng -->
<!--                                            <td class="cell-Table">-->
<!--                                                <combo-box-->
<!--                                                    name="constract{{i}}"-->
<!--                                                    id="constract{{i}}"-->
<!--                                                    [dataList]="emContractList"-->
<!--                                                    [listColumns]="[pPInvoice.currentBook === '0'?'noFBook':'noMBook','description']"-->
<!--                                                    displayMember="{{pPInvoice.currentBook === '0'?'noFBook':'noMBook'}}"-->
<!--                                                    valueName="id"-->
<!--                                                    [headerColumns]="['Số hợp đồng','Trích yếu']"-->
<!--                                                    [isObject]="true"-->
<!--                                                    [isOutTable]="true"-->
<!--                                                    [(ngModel)]="detail.emContractItem"-->
<!--                                                    (ngModelChange)="selectChangeEmContractItem(detail)"-->
<!--                                                    [tabindex]="23+(8 * i) + 56 + 5">-->
<!--                                                </combo-box>-->
<!--                                            </td>-->
                                            <!-- Mục thu/chi -->
                                            <td class="cell-Table">
                                                <combo-box idIp="budgetItem{{i}}"
                                                           nameIp="budgetItem{{i}}"
                                                           [dataList]="budgetItemList"
                                                           [listColumns]="utilsService.listColumnsBudgetItem"
                                                           displayMember="budgetItemCode"
                                                           valueName="id"
                                                           [headerColumns]="utilsService.listHeaderColumnsBudgetItem"
                                                           [isOutTable]="false"
                                                           [isObject]="true"
                                                           [(ngModel)]="detail.budgetItem"
                                                           (ngModelChange)="selectChangeBudgetItem(detail)"
                                                           [tabindex]="23+(8 * i) + 56 + 6"
                                                           [nameCategory]="utilsService.MUC_THU_CHI"
                                                           [showIconPlus]="true"
                                                           (click)="saveDetails(i)"
                                                           (focusInput)="actionFocus(52, i)">
                                                </combo-box>
                                            </td>
                                            <!-- Phòng ban  -->
                                            <td class="cell-Table">
                                                <combo-box idIp="organizationUnit{{i}}"
                                                           nameIp="organizationUnit{{i}}"
                                                           [dataList]="organizationUnits"
                                                           [listColumns]="utilsService.listColumnsOrganizationUnit"
                                                           displayMember="organizationUnitCode"
                                                           valueName="id"
                                                           [headerColumns]="utilsService.listHeaderColumnsOrganizationUnit"
                                                           [isOutTable]="false"
                                                           [isObject]="true"
                                                           [(ngModel)]="detail.organizationUnitItem"
                                                           (ngModelChange)="selectChangeOrganizationUnitItem(detail)"
                                                           [tabindex]="23+(8 * i) + 56 + 7"
                                                           [nameCategory]="utilsService.PHONG_BAN"
                                                           [showIconPlus]="true"
                                                           (click)="saveDetails(i)"
                                                           (focusInput)="actionFocus(53, i)">
                                                </combo-box>
                                            </td>
                                            <!--  Mã thống kê -->
                                            <td class="cell-Table">
                                                <combo-box idIp="statisticsCode{{i}}"
                                                           nameIp="statisticsCode{{i}}"
                                                           [dataList]="statisticCodes"
                                                           [listColumns]="utilsService.listColumnsStatisticCode"
                                                           displayMember="statisticsCode"
                                                           valueName="id"
                                                           [headerColumns]="utilsService.listHeaderColumnsStatisticCode"
                                                           [isOutTable]="false"
                                                           [isObject]="true"
                                                           [(ngModel)]="detail.statisticsCodeItem"
                                                           (ngModelChange)="selectChangeStatisticsCodeItem(detail)"
                                                           [tabindex]="23+(8 * i) + 56 + 8"
                                                           (keydown.tab)="addLastInput(i)"
                                                           [nameCategory]="utilsService.MA_THONG_KE"
                                                           [showIconPlus]="true"
                                                           (click)="saveDetails(i)"
                                                           (focusInput)="actionFocus(54, i)">
                                                </combo-box>
                                            </td>
                                        </tr>
                                        <tr *ngIf="!isReadOnly" (click)="addNewRow(1)">
                                            <td class="jsgrid-cell"><input id=" materialGoodTK" type="text" class="input-Cell"
                                                       placeholder="{{'ebwebApp.purchaseOrder.addNewLine' | translate}}" readonly></td>
                                            <td class="jsgrid-cell jsgrid-align-right"><input id="descriptionTK" type="text" class="input-Cell" readonly></td>
                                            <td class="jsgrid-cell jsgrid-align-right"><input id="expenseItem" type="text" class="input-Cell" readonly></td>
                                            <td class="jsgrid-cell jsgrid-align-right"><input id="costSetItem" type="text" class="input-Cell" readonly></td>
<!--                                            class="jsgrid-cell jsgrid-align-right" <td></td>-->
                                            <td class="jsgrid-cell jsgrid-align-right"><input id="budgetItem" type="text" class="input-Cell" readonly></td>
                                            <td class="jsgrid-cell jsgrid-align-right"><input id="organizationUnit" type="text" class="input-Cell" readonly></td>
                                            <td class="jsgrid-cell jsgrid-align-right"><input id="statisticsCode" type="text" class="input-Cell" readonly></td>

                                        </tr>
                                        <tr *ngFor="let item of newArr(10-(pPInvoice.ppInvoiceDetails ? pPInvoice.ppInvoiceDetails.length : 0))">
                                            <td class="jsgrid-cell jsgrid-align-right">&nbsp;</td>
                                            <td class="jsgrid-cell jsgrid-align-right">&nbsp;</td>
                                            <td class="jsgrid-cell jsgrid-align-right">&nbsp;</td>
                                            <td class="jsgrid-cell jsgrid-align-right">&nbsp;</td>
<!--                                            class="jsgrid-cell jsgrid-align-right" &nbsp;<td></td>-->
                                            <td class="jsgrid-cell jsgrid-align-right">&nbsp;</td>
                                            <td class="jsgrid-cell jsgrid-align-right">&nbsp;</td>
                                            <td class="jsgrid-cell jsgrid-align-right">&nbsp;</td>
                                        </tr>
                                        </tbody>
                                        <tfoot>
                                        <td colspan="7" class="pd-10-tfoot">&nbsp;
                                            <span class="color-tfoot"
                                                  jhiTranslate="ebwebApp.pPInvoice.totalRow" translateValues="{total: '{{pPInvoice.ppInvoiceDetails.length}}'}"></span>
                                        </td>
                                        </tfoot>
                                    </table>
                                </div>
                            </div>
                        </div>
                    </ng-template>
                </ngb-tab>
                <ngb-tab id ="PPInvoice-tab-cost-voucher">
                    <ng-template ngbTabTitle>
                        <span jhiTranslate="ebwebApp.pPInvoice.chungTuChiPhi">Chứng từ chi phí</span>
                    </ng-template>
                    <ng-template ngbTabContent>
                        <div class="tab-content">
                            <div class="frm-main frm-padding tab-pane fade in active show" id="cost-voucher"
                                 style="background: #cbdcf0">
                                <div id="table-scroll-detail-cost-voucher" class="table-scroll">
                                    <table id="main-table-detail-cost-voucher" class="main-table">
                                        <thead>
                                        <th scope="col" jhiTranslate="ebwebApp.pPInvoice.noFBook">Số chứng từ</th>
                                        <th scope="col" jhiTranslate="ebwebApp.pPInvoice.postedDate">Ngày hạch toán</th>
                                        <th scope="col" jhiTranslate="ebwebApp.pPInvoice.date">Ngày chứng từ</th>
                                        <th scope="col" jhiTranslate="ebwebApp.pPInvoice.provider">Nhà cung cấp</th>
                                        <th scope="col" jhiTranslate="ebwebApp.pPInvoice.sumFreightAmount">Tổng chi phí mua</th>
                                        <th scope="col" jhiTranslate="ebwebApp.pPInvoice.chiPhiPhanBoLanNay">Chi phí phân bổ lần này</th>
                                        <th scope="col" jhiTranslate="ebwebApp.pPInvoice.chiPhiDaLuyKe">Chi phí đã lũy kế</th>
                                        </thead>
                                        <tbody>
                                        <tr *ngFor="let detailCost of pPInvoice.ppInvoiceDetailCost; let i = index"
                                            oncontextmenu="return false;"
                                            (contextmenu)="onRightClick($event, pPInvoice.ppInvoiceDetailCost, detailCost, false, true, false)"
                                            (keydown.control.insert)="addNewRow(2)"
                                            (keydown.control.c)="copyRow(detailCost, 2)"
                                            (keydown.control.delete)="keyPress(i, 2)">
                                            <td class="cell-Table jsgrid-cell jsgrid-align-left pd-l-r-5">
                                                <span style="color:blue; text-decoration: underline;" class="border-0" (click)="utilsService.viewRefVoucher({refID2: detailCost.ppServiceID, typeGroupID: GROUP_ID.GROUP_PPSERVICE})" *ngIf="pPInvoice.currentBook && pPInvoice.currentBook === '0'">{{detailCost.noFBook}}</span>
                                                <span style="color:blue; text-decoration: underline;" class="border-0" (click)="utilsService.viewRefVoucher({refID2: detailCost.ppServiceID, typeGroupID: GROUP_ID.GROUP_PPSERVICE})" *ngIf="pPInvoice.currentBook && pPInvoice.currentBook !== '0'">{{detailCost.noMBook}}</span>
                                            </td>
                                            <td class="cell-Table jsgrid-cell jsgrid-align-center">
                                                <span class="border-0">
                                                    {{detailCost.postedDate | date:'dd/MM/yyyy'}}
                                                </span>
                                            </td>
                                            <td class="cell-Table jsgrid-cell jsgrid-align-center">
                                                <span class="border-0">
                                                    {{detailCost.date | date:'dd/MM/yyyy'}}
                                                </span>
                                            </td>
                                            <td class="cell-Table jsgrid-cell jsgrid-align-left pd-l-r-5 one-long-line" title="{{detailCost.accountingObjectName}}">
                                                <span class="border-0 one-long-line">
                                                    {{detailCost.accountingObjectName}}
                                                </span>
                                            </td>
                                            <td class="cell-Table jsgrid-cell jsgrid-align-right">
                                                <input class="form-control form-control-sm" type="number"
                                                       style="border: none !important" name="totalFreightAmountPb" [class.noEdit]="true"
                                                       [(ngModel)]="detailCost.totalFreightAmount"
                                                       ebCurrencyMask [systemOptions]="account?.systemOption"
                                                       [type]="7">
                                            </td>
                                            <td class="cell-Table jsgrid-cell jsgrid-align-right">
                                                <input class="form-control form-control-sm" type="number" name="amountOriginalPb"
                                                       style="border: none !important"
                                                       [(ngModel)]="detailCost.amount" [class.noEdit]="true"
                                                       ebCurrencyMask [systemOptions]="account?.systemOption"
                                                       [type]="7">
                                            </td>
                                            <td class="cell-Table jsgrid-cell jsgrid-align-right">
                                                <input class="form-control form-control-sm" type="number" name="accumulatedAllocateAmount"
                                                       style="border: none !important"
                                                       [(ngModel)]="detailCost.accumulatedAllocateAmount" [class.noEdit]="true"
                                                       ebCurrencyMask [systemOptions]="account?.systemOption"
                                                       [type]="7">
                                            </td>
                                        </tr>
                                        <tr *ngFor="let item of newArr(10-(pPInvoice.ppInvoiceDetailCost ? pPInvoice.ppInvoiceDetailCost.length : 0))">
                                            <td class="jsgrid-cell jsgrid-align-right">&nbsp;</td>
                                            <td class="jsgrid-cell jsgrid-align-right">&nbsp;</td>
                                            <td class="jsgrid-cell jsgrid-align-right">&nbsp;</td>
                                            <td class="jsgrid-cell jsgrid-align-right">&nbsp;</td>
                                            <td class="jsgrid-cell jsgrid-align-right">&nbsp;</td>
                                            <td class="jsgrid-cell jsgrid-align-right">&nbsp;</td>
                                            <td class="jsgrid-cell jsgrid-align-right">&nbsp;</td>
                                        </tr>
                                        </tbody>
                                        <tfoot>
                                        <td colspan="7" class="pd-10-tfoot">&nbsp;
                                            <span class="color-tfoot"
                                                  jhiTranslate="ebwebApp.pPInvoice.totalRow" translateValues="{total: '{{pPInvoice.ppInvoiceDetailCost.length}}'}"></span>
                                        </td>
                                        </tfoot>
                                    </table>
                                </div>
                            </div>
                        </div>
                    </ng-template>
                </ngb-tab>

                <ngb-tab id ="muaDichVu-tab-reference-voucher">
                    <ng-template ngbTabTitle>
                        <span jhiTranslate="ebwebApp.muaHang.muaDichVu.tableDetail.tabs.referenceVoucher">Chi tiết</span>
                    </ng-template>
                    <ng-template ngbTabContent>
                        <div class="tab-content" >
                            <div class="frm-main frm-padding tab-pane fade in active show" id="referenceVoucher-tabs"
                                 style="background: #cbdcf0">
                                <div id="table-scroll-detail-referenceVoucher" class="table-scroll">
                                    <table id="main-table-detail-referenceVoucher" class="main-table">
                                        <thead>
                                        <th scope="col" jhiTranslate="ebwebApp.muaHang.muaDichVu.tableDetail.receiptDate"></th>
                                        <th scope="col" jhiTranslate="ebwebApp.muaHang.muaDichVu.tableDetail.postedDate"></th>
                                        <th scope="col" jhiTranslate="ebwebApp.muaHang.muaDichVu.tableDetail.noBook"></th>
                                        <th scope="col" jhiTranslate="ebwebApp.muaHang.muaDichVu.tableDetail.explain"></th>
                                        </thead>
                                        <tbody>
                                        <tr *ngFor="let viewVoucher of pPInvoice.refVouchers; let i = index"
                                            oncontextmenu="return false;"
                                            (contextmenu)="onRightClick($event, pPInvoice.refVouchers, viewVoucher, false, true, false)">
                                            <td class="cell-Table jsgrid-cell jsgrid-align-center line-h">
                                                <span>
                                                    {{viewVoucher.date}}
                                                </span>
                                            </td>
                                            <td class="cell-Table jsgrid-cell jsgrid-align-center line-h">
                                                <span>
                                                    {{viewVoucher.postedDate}}
                                                </span>
                                            </td>
                                            <td class="cell-Table jsgrid-cell jsgrid-align-left line-h pd-l-r-5"
                                                (click)="utilsService.viewRefVoucher(viewVoucher)"
                                                style="color:blue; text-decoration: underline;">{{viewVoucher.no}}
                                            </td>
                                            <td class="cell-Table jsgrid-cell jsgrid-align-left line-h pd-l-r-5">
                                                <span>
                                                    {{viewVoucher.reason}}
                                                </span>
                                            </td>
                                        </tr>
                                        <tr *ngFor="let item of newArr(10-(pPInvoice.refVouchers ? pPInvoice.refVouchers.length : 0))">
                                            <td class="jsgrid-cell jsgrid-align-right">&nbsp;</td>
                                            <td class="jsgrid-cell jsgrid-align-right">&nbsp;</td>
                                            <td class="jsgrid-cell jsgrid-align-right">&nbsp;</td>
                                            <td class="jsgrid-cell jsgrid-align-right">&nbsp;</td>
                                        </tr>
                                        </tbody>
                                        <tfoot>
                                        <td colspan="4">&nbsp;
                                            <span class="color-tfoot"
                                                  jhiTranslate="ebwebApp.pPInvoice.totalRow" translateValues="{total: '{{pPInvoice.refVouchers.length}}'}"></span>
                                        </td>
                                        </tfoot>
                                    </table>
                                </div>
                            </div>
                        </div>
                    </ng-template>
                </ngb-tab>

                <ngb-tab id ="ppinvoice-tab-liabilities" [disabled]="isReadOnly">
                    <ng-template ngbTabTitle>
                        <span jhiTranslate="ebwebApp.muaHang.muaDichVu.tableDetail.tabs.Liabilities">xem công nợ</span>
                    </ng-template>
                </ngb-tab>
                <ngb-tab id ="ppinvoice-tab-pp-order" [disabled]="isReadOnly">
                    <ng-template ngbTabTitle>
                        <span jhiTranslate="ebwebApp.muaHang.muaDichVu.tableDetail.tabs.ppOrder">Đơn mua hàng</span>
                    </ng-template>
                </ngb-tab>
                <ngb-tab id ="ppinvoice-tab-pp-reference" [disabled]="isReadOnly">
                    <ng-template ngbTabTitle>
                        <span jhiTranslate="ebwebApp.muaHang.muaDichVu.tableDetail.tabs.reference">Tham chiếu</span>
                    </ng-template>
                </ngb-tab>
                <ngb-tab id ="ppinvoice-tab-allocation" [disabled]="isReadOnly">
                    <ng-template ngbTabTitle>
                        <div ngbDropdown class="d-inline-block" style="height: 32px !important; max-height: 32px !important;">
                            <button class="dropdown-btn" id="dropdown" ngbDropdownToggle
                                    jhiTranslate="ebwebApp.pPInvoice.pb" [disabled]="isReadOnly">Phân bổ</button>
                            <div ngbDropdownMenu aria-labelledby="dropdown" style="padding: 0 !important;">
                                <button *ngIf="pPInvoice.isImportPurchase" class="dropdown-i hover" jhiTranslate="ebwebApp.pPInvoice.pbChiPhiHq" (click)="costAllocation(true)">Phân bổ chi phí trước HQ</button>
                                <button class="dropdown-i hover" jhiTranslate="ebwebApp.pPInvoice.pbChiPhi" (click)="costAllocation(false)">Phân bổ chi phí</button>
                                <button class="dropdown-i hover" jhiTranslate="ebwebApp.pPInvoice.pbChietKhau" (click)="discountAllocation()">Phân bổ ck</button>
                            </div>
                        </div>
                    </ng-template>
                </ngb-tab>
            </ngb-tabset>
        </div>

        <div class="row no-gutters">
            <div class="col-md-2 row no-gutters">
                <div class="offset-sm-2" style="margin-left: 13px">
                    <input class="form-check-input" type="checkbox" id="checkBox" style="width: 25px; height: 25px"
                           [(ngModel)]="pPInvoice.billReceived" (ngModelChange)="changeBillReceive()">
                    <label class="form-check-label" for="checkBox"
                           style="font-size: 14px; margin-left: 9px; line-height: 3; margin-top: -3px" jhiTranslate="ebwebApp.pPInvoice.billReceived">Đã nhận hóa đơn</label>
                </div>
            </div>
            <div class="col-md-10 row no-gutters justify-content-end eb-read-only pd-0-footer">
                <div class="col-md-4 justify-content-end pd-0-footer">
                    <div class="row no-gutters">
                        <label class="col-sm-4 text-left pd-0-footer" jhiTranslate="ebwebApp.pPInvoice.totalAmount2">Tiền Hàng</label>
                        <div class="col-sm-4 pd-0-footer">
                            <input class="form-control form-control-sm" type="number" name="totalAmountOriginal"
                                   [(ngModel)]="pPInvoice.totalAmountOriginal"
                                   ebCurrencyMask [systemOptions]="account?.systemOption"
                                   [class.noEdit]="true" [type]="pPInvoice.currencyId !== currencyCode ? 8 : 7">
                        </div>
                        <div class="col-md-4 pd-0-footer">
                            <input class="form-control form-control-sm" type="number" name="totalAmount"
                                   [(ngModel)]="pPInvoice.totalAmount" [class.noEdit]="true"
                                   ebCurrencyMask [systemOptions]="account?.systemOption"
                                   [type]="7">
                        </div>
                    </div>
                    <div class="row no-gutters">
                        <label class="col-sm-4 text-left pd-0-footer" jhiTranslate="ebwebApp.pPInvoice.totalImportTaxAmount">Tiền thuế
                            NK</label>
                        <div class="col-sm-4 pd-0-footer">
                            <input class="form-control form-control-sm" type="number" *ngIf="!pPInvoice.isImportPurchase"
                                   name="totalImportTaxAmountOriginal"
                                   [(ngModel)]="pPInvoice.totalImportTaxAmountOriginal" [class.noEdit]="true"
                                   ebCurrencyMask [systemOptions]="account?.systemOption"
                                   [type]="pPInvoice.currencyId !== currencyCode ? 8 : 7">
                            <input class="form-control form-control-sm" *ngIf="pPInvoice.isImportPurchase">
                        </div>
                        <div class="col-md-4 pd-0-footer">
                            <input class="form-control form-control-sm" type="number" name="totalImportTaxAmount"
                                   [(ngModel)]="pPInvoice.totalImportTaxAmount" [class.noEdit]="true"
                                   ebCurrencyMask [systemOptions]="account?.systemOption"
                                   [type]="7">
                        </div>
                    </div>
                    <div class="row no-gutters">
                        <label  class="col-sm-4 text-left pd-0-footer" jhiTranslate="ebwebApp.pPInvoice.totalFreightAmount">Chi phí mua</label>
                        <div class="col-sm-4 pd-0-footer">
                            <input class="form-control form-control-sm" type="number" name="totalFreightAmountOriginal" *ngIf="!pPInvoice.isImportPurchase"
                                   [(ngModel)]="pPInvoice.totalFreightAmountOriginal" [class.noEdit]="true"
                                   ebCurrencyMask [systemOptions]="account?.systemOption"
                                   [type]="pPInvoice.currencyId !== currencyCode ? 8 : 7">
                            <input class="form-control form-control-sm" *ngIf="pPInvoice.isImportPurchase">
                        </div>
                        <div class="col-md-4 pd-0-footer">
                            <input class="form-control form-control-sm" type="number" name="totalFreightAmount"
                                   [(ngModel)]="pPInvoice.totalFreightAmount" [class.noEdit]="true"
                                   ebCurrencyMask [systemOptions]="account?.systemOption"
                                   [type]="7">
                        </div>
                    </div>
                </div>
                <div class="col-md-4 justify-content-end pd-0-footer">
                    <div class="row no-gutters">
                        <label  class="col-sm-4 text-left pd-0-footer" jhiTranslate="ebwebApp.pPInvoice.totalDiscountAmount">Tiền CK</label>
                        <div class="col-sm-4 pd-0-footer">
                            <input class="form-control form-control-sm" type="number" name="totalDiscountAmountOriginal"
                                   [(ngModel)]="pPInvoice.totalDiscountAmountOriginal" [class.noEdit]="true"
                                   ebCurrencyMask [systemOptions]="account?.systemOption"
                                   [type]="pPInvoice.currencyId !== currencyCode ? 8 : 7">
                        </div>
                        <div class="col-md-4 pd-0-footer">
                            <input class="form-control form-control-sm" type="number" name="totalDiscountAmount"
                                   [(ngModel)]="pPInvoice.totalDiscountAmount" [class.noEdit]="true"
                                   ebCurrencyMask [systemOptions]="account?.systemOption"
                                   [type]="7">
                        </div>
                    </div>
                    <div class="row no-gutters">
                        <label  class="col-sm-4 text-left pd-0-footer" jhiTranslate="ebwebApp.pPInvoice.totalSpecialConsumeTaxAmount">Tiền thuế
                            TTĐB</label>
                        <div class="col-sm-4 pd-0-footer">
                            <input class="form-control form-control-sm" type="number"
                                   name="totalSpecialConsumeTaxAmountOriginal"
                                   [(ngModel)]="pPInvoice.totalSpecialConsumeTaxAmountOriginal" [class.noEdit]="true" *ngIf="!pPInvoice.isImportPurchase"
                                   ebCurrencyMask [systemOptions]="account?.systemOption"
                                   [type]="pPInvoice.currencyId !== currencyCode ? 8 : 7">
                            <input class="form-control form-control-sm" *ngIf="pPInvoice.isImportPurchase">
                        </div>
                        <div class="col-md-4 pd-0-footer">
                            <input class="form-control form-control-sm" type="number"
                                   name="totalSpecialConsumeTaxAmount"
                                   [(ngModel)]="pPInvoice.totalSpecialConsumeTaxAmount" [class.noEdit]="true"
                                   ebCurrencyMask [systemOptions]="account?.systemOption"
                                   [type]="7">
                        </div>
                    </div>
                    <div class="row no-gutters">
                        <label  class="col-sm-4 text-left pd-0-footer" jhiTranslate="ebwebApp.pPInvoice.totalImportTaxExpenseAmount">CP trước
                            HQ</label>
                        <div class="col-sm-4 pd-0-footer">
                            <input class="form-control form-control-sm" type="number"
                                   name="totalImportTaxAmountOriginal"
                                   [(ngModel)]="pPInvoice.totalImportTaxExpenseAmountOriginal" [class.noEdit]="true" *ngIf="!pPInvoice.isImportPurchase"
                                   ebCurrencyMask [systemOptions]="account?.systemOption"
                                   [type]="pPInvoice.currencyId !== currencyCode ? 8 : 7">
                            <input class="form-control form-control-sm" *ngIf="pPInvoice.isImportPurchase">
                        </div>
                        <div class="col-md-4 pd-0-footer">
                            <input class="form-control form-control-sm" type="number" name="totalImportTaxAmount"
                                   [(ngModel)]="pPInvoice.totalImportTaxExpenseAmount" [class.noEdit]="true"
                                   ebCurrencyMask [systemOptions]="account?.systemOption"
                                   [type]="7">
                        </div>
                    </div>
                </div>
                <div class="col-md-4 justify-content-end pd-0-footer">
                    <div class="row no-gutters">
                        <label  class="col-sm-4 text-left pd-0-footer" jhiTranslate="ebwebApp.pPInvoice.totalVATAmount2">Thuế GTGT</label>
                        <div class="col-sm-4 pd-0-footer">
                            <input class="form-control form-control-sm" type="number" name="totalVATAmountOriginal" *ngIf="!pPInvoice.isImportPurchase"
                                   [(ngModel)]="pPInvoice.totalVATAmountOriginal" [class.noEdit]="true"
                                   ebCurrencyMask [systemOptions]="account?.systemOption"
                                   [type]="pPInvoice.currencyId !== currencyCode ? 8 : 7">
                            <input class="form-control form-control-sm" *ngIf="pPInvoice.isImportPurchase">
                        </div>
                        <div class="col-md-4 pd-0-footer">
                            <input class="form-control form-control-sm" type="number" name="totalVATAmount"
                                   [(ngModel)]="pPInvoice.totalVATAmount" [class.noEdit]="true"
                                   ebCurrencyMask [systemOptions]="account?.systemOption"
                                   [type]="7">
                        </div>
                    </div>
                    <div class="row no-gutters">
                        <label  class="col-sm-4 text-left pd-0-footer" jhiTranslate="ebwebApp.pPInvoice.totalAmountPay">Tổng tiền TT</label>
                        <div class="col-md-4 pd-0-footer">
                            <input class="form-control form-control-sm" type="number" name="importAmount"
                                   [(ngModel)]="amountOriginal" [class.noEdit]="true"
                                   ebCurrencyMask [systemOptions]="account?.systemOption"
                                   [type]="pPInvoice.currencyId !== currencyCode ? 8 : 7">
                        </div>
                        <div class="col-sm-4 pd-0-footer">
                            <input class="form-control form-control-sm" type="number" name="domesticAmount"
                                   [(ngModel)]="amount" [class.noEdit]="true"
                                   ebCurrencyMask [systemOptions]="account?.systemOption"
                                   [type]="7">
                        </div>
                    </div>
                    <div class="row no-gutters">
                        <label  class="col-sm-4 text-left pd-0-footer" [jhiTranslate]="isKho ? 'ebwebApp.pPInvoice.totalInwardAmount' : 'ebwebApp.pPInvoice.totalValue'">Giá nhập kho</label>
                        <div class="col-sm-4 pd-0-footer">
                            <input class="form-control form-control-sm" type="number" name="totalInwardAmountOriginal" *ngIf="!pPInvoice.isImportPurchase"
                                   [(ngModel)]="pPInvoice.totalInwardAmountOriginal" [class.noEdit]="true"
                                   ebCurrencyMask [systemOptions]="account?.systemOption"
                                   [type]="pPInvoice.currencyId !== currencyCode ? 8 : 7">
                            <input class="form-control form-control-sm" *ngIf="pPInvoice.isImportPurchase">
                        </div>
                        <div class="col-md-4 pd-0-footer">
                            <input class="form-control form-control-sm" type="number" name="totalInwardAmount"
                                   [(ngModel)]="pPInvoice.totalInwardAmount" [class.noEdit]="true"
                                   ebCurrencyMask [systemOptions]="account?.systemOption"
                                   [type]="7">
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>

<!--xóa-->
<ng-template #deleteItem let-d="dismiss">
    <div class="modal-body">
        <form>
            <div class="form-group">
                <label jhiTranslate="ebwebApp.pPInvoice.deletePPInvoice"></label>
            </div>
        </form>
    </div>
    <div class="modal-footer">
        <button [class.disable]="isLoading" type="button" class="btn btn-outline-danger" (click)="deletePPI()"
                jhiTranslate="entity.action.ok">
        </button>
        <button type="button" class="btn btn-outline-dark" (click)="d('Close')"
                jhiTranslate="ebwebApp.mBDeposit.return">
        </button>
    </div>
</ng-template>

<eb-context-menu [contextMenu]="contextMenu" [useCopyRow]="true" [isMaterialGoodsSpecification]="true"></eb-context-menu>

<ng-template #content let-modal>
    <div class="modal-body">
        <form>
            <div class="form-group">
                <label jhiTranslate="ebwebApp.saBill.saveMessage">Dữ liệu đã bị thay đổi, Bạn có muốn lưu lại?</label>
            </div>
        </form>
    </div>
    <div class="modal-footer">
        <button type="button" class="btn btn-outline-success" (click)="savePPI(false, quantityLargerModal)" jhiTranslate="entity.action.save">Save</button>
        <button type="button" class="btn btn-outline-danger" (click)="close()" jhiTranslate="entity.action.noSave">Save</button>
        <button type="button" class="btn btn-outline-dark" (click)="closeModal()" jhiTranslate="entity.action.close">close</button>
<!--        <button type="button" class="btn btn-outline-dark" (click)="closePopup()" jhiTranslate="entity.action.close">close</button>-->
    </div>
</ng-template>

<ng-template #unRecordModal let-d="dismiss">
    <form name="unRecordForm">
        <div class="modal-header">
            <h4 class="modal-title" jhiTranslate="ebwebApp.pPInvoice.unrRecordAlert"></h4>
            <button type="button" class="close" data-dismiss="modal" aria-hidden="true"
                    (click)="d('Close')">&times;</button>
        </div>
        <div class="modal-body">
            <p *ngIf="isUsed" jhiTranslate="ebwebApp.pPInvoice.unrRecordTitle"></p>
            <p *ngIf="isPlayVendor" jhiTranslate="ebwebApp.pPInvoice.error.unrRecordPlayVendor"></p>
        </div>
        <div class="modal-footer">
            <button type="button" class="btn btn-eb" [class.disable]="isLoading" (click)="unRecordPPI()" jhiTranslate="entity.action.ok">Save</button>
            <button type="button" class="btn btn-light" (click)="d('Close')" jhiTranslate="entity.action.close">close</button>
        </div>
    </form>
</ng-template>

<ng-template #quantityLargerModal let-d="dismiss">
    <div class="modal-body">
        <form>
            <div class="form-group">
                <label jhiTranslate="ebwebApp.muaHang.muaDichVu.toastr.saveWhenQuantityLarger"></label>
            </div>
        </form>
    </div>
    <div class="modal-footer">
        <button type="button" class="btn btn-outline-primary" (click)="saveByQuantityLargerModal()" jhiTranslate="entity.action.ok">ok</button>
        <button type="button" class="btn btn-outline-dark" (click)="modalRef.close()" jhiTranslate="entity.action.cancel">cancel</button>
    </div>
</ng-template>

<ng-template #contentVAT let-quantityExists="dismiss">
    <div class="modal-body">
        <form>
            <div class="form-group">
                <label *ngIf="checkVATError === 2" jhiTranslate="ebwebApp.pPDiscountReturnDetails.error.vatRateNull">% thuế
                    null</label>
                <label *ngIf="checkVATError === 3" jhiTranslate="ebwebApp.pPDiscountReturnDetails.error.vatRateZero">% thuế =
                    0</label>
            </div>
        </form>
    </div>
    <div class="modal-footer">
        <button type="button" class="btn btn-outline-success" (click)="checkVat();quantityExists('Close')"
                jhiTranslate="entity.action.save">Save
        </button>
        <button type="button" class="btn btn-outline-dark" (click)="changeCheckVATError();quantityExists('Close')"
                jhiTranslate="entity.action.close">close
        </button>
    </div>
</ng-template>

